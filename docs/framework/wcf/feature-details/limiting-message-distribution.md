---
title: Beschränken der Nachrichtenverteilung
ms.date: 03/30/2017
ms.assetid: 8b5ec4b8-1ce9-45ef-bb90-2c840456bcc1
ms.openlocfilehash: e736aba60d7d2b39d1b8eb958a8c72e6e8d55e13
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/15/2020
ms.locfileid: "90555015"
---
# <a name="limiting-message-distribution"></a><span data-ttu-id="46bda-102">Beschränken der Nachrichtenverteilung</span><span class="sxs-lookup"><span data-stu-id="46bda-102">Limiting Message Distribution</span></span>

<span data-ttu-id="46bda-103">Der Peerkanal ist als Übertragungsnetz konzipiert.</span><span class="sxs-lookup"><span data-stu-id="46bda-103">Peer Channel is by design a broadcast mesh.</span></span> <span data-ttu-id="46bda-104">Das grundlegende Weitergabemodell umfasst die Verteilung jeder Nachricht, die von einem Mitglied eines Netzes gesendet wird, an alle anderen Mitglieder dieses Netzes.</span><span class="sxs-lookup"><span data-stu-id="46bda-104">Its basic flooding model involves distributing each message sent by any member of a mesh to all other members of that mesh.</span></span> <span data-ttu-id="46bda-105">Dies ist besonders in Situationen von Vorteil, in denen jede von einem Mitglied generierte Nachricht für alle anderen Mitglieder relevant und hilfreich ist – beispielsweise in einem Chatraum.</span><span class="sxs-lookup"><span data-stu-id="46bda-105">This is ideal in situations where every message generated by a member is relevant and useful to all other members (for example, a chat room).</span></span> <span data-ttu-id="46bda-106">Bei vielen Anwendungen muss die Nachrichtenverteilung jedoch gelegentlich eingeschränkt werden.</span><span class="sxs-lookup"><span data-stu-id="46bda-106">However, many applications have an occasional need for limiting message distribution.</span></span> <span data-ttu-id="46bda-107">Tritt beispielsweise ein neues Mitglied dem Netz bei und möchte die letzte durch das Netz gesendete Nachricht abrufen, muss diese Anforderung nicht an alle Mitglieder des Netzes weitergeleitet werden.</span><span class="sxs-lookup"><span data-stu-id="46bda-107">For example, if a new member joins a mesh and wants to retrieve the last message sent through the mesh, this request does not need to be flooded to every member of the mesh.</span></span> <span data-ttu-id="46bda-108">Die Anforderung kann auf nahe Nachbarn beschränkt werden, oder lokal generierte Nachrichten können herausgefiltert werden. Nachrichten können auch an einen einzelnen Knoten im Mesh gesendet werden.</span><span class="sxs-lookup"><span data-stu-id="46bda-108">The request could be limited to near neighbors, or locally generated messages can be filtered out. Messages can also be sent to an individual node on the mesh.</span></span> <span data-ttu-id="46bda-109">In diesem Thema wird erläutert, wie mithilfe der Hopanzahl, eines Nachrichtenweitergabefilters, eines lokalen Filters oder einer Direktverbindung gesteuert werden kann, auf welche Weise Nachrichten innerhalb des Netzes weitergeleitet werden. Darüber hinaus finden Sie hier allgemeine Richtlinien für die Auswahl eines geeigneten Ansatzes.</span><span class="sxs-lookup"><span data-stu-id="46bda-109">This topic discusses using Hop Count, a Message Propagation Filter, a local filter, or a direct connection to control how messages are forwarded throughout the mesh, and provides general guidelines for choosing an approach.</span></span>

## <a name="hop-counts"></a><span data-ttu-id="46bda-110">Hopanzahl</span><span class="sxs-lookup"><span data-stu-id="46bda-110">Hop Counts</span></span>

<span data-ttu-id="46bda-111">Das `PeerHopCount`-Konzept ähnelt dem im IP verwendeten TTL (Time-To-Live)-Konzept.</span><span class="sxs-lookup"><span data-stu-id="46bda-111">The concept of `PeerHopCount` is similar to TTL (Time-To-Live) used in IP protocol.</span></span> <span data-ttu-id="46bda-112">Der `PeerHopCount`-Wert ist mit einer Nachrichteninstanz verknüpft und gibt an, wie häufig eine Nachricht weitergeleitet werden soll, bis sie verworfen wird.</span><span class="sxs-lookup"><span data-stu-id="46bda-112">The value of `PeerHopCount` is tied to a message instance, and it specifies how many times a message should be forwarded before being dropped.</span></span> <span data-ttu-id="46bda-113">Jedes Mal, wenn eine Nachricht von einem Peerkanalclient empfangen wird, wird vom Client geprüft, ob für die Nachricht ein `PeerHopCount` angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="46bda-113">Each time a message is received by a Peer Channel client, the client examines the message to see if `PeerHopCount` is specified.</span></span> <span data-ttu-id="46bda-114">Ist ein solcher Wert vorhanden, wird die Hopanzahl durch den Client um "1" verringert, bevor die Nachricht an benachbarte Knoten weitergeleitet wird.</span><span class="sxs-lookup"><span data-stu-id="46bda-114">If it is specified, then the client decrements the hop count value by one before forwarding the message to neighboring nodes.</span></span> <span data-ttu-id="46bda-115">Erhält ein Client eine Nachricht mit der Hopanzahl "0", wird die Nachricht zwar verarbeitet, aber nicht mehr an Nachbarn weitergeleitet.</span><span class="sxs-lookup"><span data-stu-id="46bda-115">When a client receives a message with a hop count value of zero, the client processes the message, but does not forward the message to neighbors.</span></span>

<span data-ttu-id="46bda-116">Sie können die Hopanzahl zu einer Nachricht hinzufügen, indem Sie `PeerHopCount` bei der Implementierung der Nachrichtenklasse als Attribut zu der anwendbaren Eigenschaft oder dem anwendbaren Feld hinzufügen.</span><span class="sxs-lookup"><span data-stu-id="46bda-116">Hop count may be added to a message by adding `PeerHopCount` as an attribute to the applicable property or field in the implementation of the message class.</span></span> <span data-ttu-id="46bda-117">Sie können hierfür vor dem Senden der Nachricht an das Netz einen bestimmten Wert festlegen.</span><span class="sxs-lookup"><span data-stu-id="46bda-117">You can set this to a specific value before sending the message to the mesh.</span></span> <span data-ttu-id="46bda-118">Auf diese Weise kann die Verteilung von Nachrichten innerhalb des Netzes mithilfe der Hopanzahl gegebenenfalls eingeschränkt werden, was zu einer Verringerung unnötiger doppelter Nachrichten führen kann.</span><span class="sxs-lookup"><span data-stu-id="46bda-118">In this manner, you can use hop count to limit distribution of messages throughout the mesh when necessary, potentially avoiding unnecessary message duplication.</span></span> <span data-ttu-id="46bda-119">Dies ist hilfreich, wenn das Netz eine große Menge redundanter Daten enthält oder wenn Nachrichten nur an direkte Nachbarn (oder an Nachbarn, die nur wenige Hops entfernt sind) gesendet werden sollen.</span><span class="sxs-lookup"><span data-stu-id="46bda-119">This is useful in cases where the mesh contains a high amount of redundant data, or for sending a message to immediate neighbors, or neighbors within a few hops.</span></span>

- <span data-ttu-id="46bda-120">Code Ausschnitte und zugehörige Informationen finden Sie im Peer Channel-Blog im [PeerHopCount-Attribut: Steuern der Nachrichten Verteilung](/archive/blogs/peerchan/the-peerhopcount-attribute-controlling-message-distribution) .</span><span class="sxs-lookup"><span data-stu-id="46bda-120">For code snippets and related information, see the [The PeerHopCount Attribute: Controlling Message Distribution](/archive/blogs/peerchan/the-peerhopcount-attribute-controlling-message-distribution) post on the Peer Channel blog.</span></span>

## <a name="message-propagation-filter"></a><span data-ttu-id="46bda-121">Nachrichtenweitergabefilter</span><span class="sxs-lookup"><span data-stu-id="46bda-121">Message Propagation Filter</span></span>

<span data-ttu-id="46bda-122">`MessagePropagationFilter` dient zum benutzerdefinierten Steuern der Nachrichtenweitergabe, besonders in Fällen, in denen die Weitergabe durch den Inhalt der Nachricht oder durch andere spezifische Szenarios bestimmt wird.</span><span class="sxs-lookup"><span data-stu-id="46bda-122">`MessagePropagationFilter` can be used for customized control of message flooding, especially when the content of the message or other specific scenarios determine propagation.</span></span> <span data-ttu-id="46bda-123">Durch den Filter werden für jede Nachricht, die den Knoten passiert, Weitergabenentscheidungen getroffen.</span><span class="sxs-lookup"><span data-stu-id="46bda-123">The filter makes propagation decisions for every message that passes through the node.</span></span> <span data-ttu-id="46bda-124">Dies gilt sowohl für Nachrichten, die von einem anderen Punkt innerhalb des Netzes stammen und von Ihrem Knoten empfangen werden, als auch für Nachrichten, die in Ihrer Anwendung erstellt wurden.</span><span class="sxs-lookup"><span data-stu-id="46bda-124">This is true for messages that originated elsewhere in the mesh that your node has received as well as messages created by your application.</span></span> <span data-ttu-id="46bda-125">Der Filter kann sowohl auf die Nachricht als auch auf deren Ursprung zugreifen, sodass Entscheidungen über die Weiterleitung oder das Verwerfen der Nachricht auf der Grundlage der vollständig verfügbaren Informationen getroffen werden können.</span><span class="sxs-lookup"><span data-stu-id="46bda-125">The filter has access to both the message and its origination, so decisions about forwarding or dropping the message can be based on the full information available.</span></span>

<span data-ttu-id="46bda-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> ist eine abstrakte Basisklasse mit einer einzelnen Funktion: <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span><span class="sxs-lookup"><span data-stu-id="46bda-126"><xref:System.ServiceModel.PeerMessagePropagationFilter> is a base abstract class with a single function, <xref:System.ServiceModel.PeerMessagePropagationFilter.ShouldMessagePropagate%2A>.</span></span> <span data-ttu-id="46bda-127">Das erste Argument des Methodenaufrufs übergibt eine vollständige Kopie der Nachricht.</span><span class="sxs-lookup"><span data-stu-id="46bda-127">The first argument of the method call passes in a full copy of the message.</span></span> <span data-ttu-id="46bda-128">Änderungen an der Nachricht wirken sich nicht auf die eigentliche Nachricht aus.</span><span class="sxs-lookup"><span data-stu-id="46bda-128">Any changes made to the message do not affect the actual message.</span></span> <span data-ttu-id="46bda-129">Das letzte Argument des Methodenaufrufs identifiziert den Ursprung der Nachricht (`PeerMessageOrigination.Local` oder `PeerMessageOrigination.Remote`).</span><span class="sxs-lookup"><span data-stu-id="46bda-129">The last argument of the method call identifies the origin of the message (`PeerMessageOrigination.Local` or `PeerMessageOrigination.Remote`).</span></span> <span data-ttu-id="46bda-130">Konkrete Implementierungen dieser Methode müssen eine Konstante aus der <xref:System.ServiceModel.PeerMessagePropagation>-Enumeration zurückgeben, die angibt, dass die Nachricht an die lokale Anwendung (`Local`), an Remoteclients (`Remote`), an beide dieser Optionen (`LocalAndRemote`) oder an keine dieser Optionen (`None`) weitergeleitet werden soll.</span><span class="sxs-lookup"><span data-stu-id="46bda-130">Concrete implementations of this method must return a constant from the <xref:System.ServiceModel.PeerMessagePropagation> enumeration indicating that the message is to be forwarded to the local application (`Local`), forwarded to remote clients (`Remote`), both (`LocalAndRemote`), or neither (`None`).</span></span> <span data-ttu-id="46bda-131">Sie können diesen Filter durch Zugreifen auf das entsprechende `PeerNode`-Objekt und Angeben einer Instanz der abgeleiteten Weitergabefilterklasse in der `PeerNode.MessagePropagationFilter`-Eigenschaft anwenden.</span><span class="sxs-lookup"><span data-stu-id="46bda-131">This filter can be applied by accessing the corresponding `PeerNode` object and specifying an instance of the derived propagation filter class in the `PeerNode.MessagePropagationFilter` property.</span></span> <span data-ttu-id="46bda-132">Vergewissern Sie sich vor dem Öffnen des Peerkanals, dass der Weitergabefilter angefügt ist.</span><span class="sxs-lookup"><span data-stu-id="46bda-132">Ensure that the propagation filter is attached before opening the Peer Channel.</span></span>

- <span data-ttu-id="46bda-133">Code Ausschnitte und zugehörige Informationen finden Sie im Peer [Channel-und MessagePropagationFilter-](/archive/blogs/peerchan/peer-channel-and-messagepropagationfilter) Beitrag im Peerkanal-Blog.</span><span class="sxs-lookup"><span data-stu-id="46bda-133">For code snippets and related information, see the [Peer Channel and MessagePropagationFilter](/archive/blogs/peerchan/peer-channel-and-messagepropagationfilter) post on the Peer Channel blog.</span></span>

## <a name="contacting-an-individual-node-in-the-mesh"></a><span data-ttu-id="46bda-134">Kontaktieren eines einzelnen Netzknotens</span><span class="sxs-lookup"><span data-stu-id="46bda-134">Contacting an Individual Node in the Mesh</span></span>

<span data-ttu-id="46bda-135">Ein einzelner Netzknoten kann durch Einrichten eines lokalen Filters oder durch Einrichten einer Direktverbindung kontaktiert werden.</span><span class="sxs-lookup"><span data-stu-id="46bda-135">An individual node in a mesh can be contacted by setting up a local filter, or by setting up a direct connection.</span></span>

<span data-ttu-id="46bda-136">Besitzen die Knoten innerhalb eines Netzes individuelle IDs, können Sie in der Implementierung Ihrer Nachricht eine Ziel-ID angeben.</span><span class="sxs-lookup"><span data-stu-id="46bda-136">If the nodes in a mesh each have an individual ID, a destination ID can be specified in the implementation of your message.</span></span> <span data-ttu-id="46bda-137">Ein lokaler Filter kann durch Schreiben einer Funktion in den Nachrichtenvertrag eingerichtet werden. Dadurch wird die Nachricht lediglich für den aktuellen Knoten angezeigt, wenn dessen ID mit der angegebenen Ziel-ID übereinstimmt.</span><span class="sxs-lookup"><span data-stu-id="46bda-137">A local filter can be set up by writing a function in your message contract that will only display the message to the current node if its ID matches the destination ID you specified.</span></span> <span data-ttu-id="46bda-138">Die Nachricht wird durch das Netz transportiert, weshalb kein Mehraufwand zum Einrichten einer neuen Verbindung entsteht.</span><span class="sxs-lookup"><span data-stu-id="46bda-138">The mesh transports the message, so the overhead of setting up a new connection does not have to be incurred.</span></span> <span data-ttu-id="46bda-139">Es ergibt sich jedoch ein Verlust an Effizienz, da die Nachricht mehrmals durch das Netz gesendet wird.</span><span class="sxs-lookup"><span data-stu-id="46bda-139">However, there is a loss of efficiency since the message is sent many times throughout the mesh.</span></span> <span data-ttu-id="46bda-140">Dieses Verfahren eignet sich gut zum Senden von Nachrichten an einzelne Mitglieder eines Netzes, vorausgesetzt, die Nachrichten sind nicht zu umfangreich und werden nicht zu häufig gesendet.</span><span class="sxs-lookup"><span data-stu-id="46bda-140">This works well for sending messages to individual members of a mesh as long as the messages are neither too big nor too frequent.</span></span>

<span data-ttu-id="46bda-141">Bei dauerhaften Verbindungen mit hoher Bandbreite empfiehlt sich die Verwendung einer Direktverbindung.</span><span class="sxs-lookup"><span data-stu-id="46bda-141">For long-lasting, high-bandwidth connections, direct connections are preferable.</span></span> <span data-ttu-id="46bda-142">Sie können Verbindungsinformationen über das Netz senden und anschließend eine Direktverbindung zum Senden/Empfangen von Nachrichten einrichten.</span><span class="sxs-lookup"><span data-stu-id="46bda-142">You can send connection information over the mesh, and then set up a direct connection of your choosing to send/receive messages.</span></span>

## <a name="choosing-an-approach-for-limiting-message-distribution"></a><span data-ttu-id="46bda-143">Auswählen eines Ansatzes zum Beschränken der Nachrichtenverteilung</span><span class="sxs-lookup"><span data-stu-id="46bda-143">Choosing an Approach for Limiting Message Distribution</span></span>

<span data-ttu-id="46bda-144">Ist eine Einschränkung der Nachrichtenverteilung erforderlich, sollten Sie sich die folgenden Fragen stellen:</span><span class="sxs-lookup"><span data-stu-id="46bda-144">When you discover a scenario in which you need to limit message distribution, ask yourself the following questions:</span></span>

- <span data-ttu-id="46bda-145">**Wer** muss die Nachricht erhalten?</span><span class="sxs-lookup"><span data-stu-id="46bda-145">**Who** needs to receive the message?</span></span> <span data-ttu-id="46bda-146">Lediglich ein Nachbarknoten?</span><span class="sxs-lookup"><span data-stu-id="46bda-146">Just one neighbor node?</span></span> <span data-ttu-id="46bda-147">Ein Knoten an einem anderen Ort im Netz?</span><span class="sxs-lookup"><span data-stu-id="46bda-147">A node somewhere else in the mesh?</span></span> <span data-ttu-id="46bda-148">Die Hälfte des Netzes?</span><span class="sxs-lookup"><span data-stu-id="46bda-148">Half the mesh?</span></span>

- <span data-ttu-id="46bda-149">**Wie oft** wird diese Nachricht gesendet?</span><span class="sxs-lookup"><span data-stu-id="46bda-149">**How often** will this message be sent?</span></span>

- <span data-ttu-id="46bda-150">Welche Art von **Bandbreite** wird von dieser Nachricht verwendet?</span><span class="sxs-lookup"><span data-stu-id="46bda-150">What kind of **bandwidth** will this message use?</span></span>

<span data-ttu-id="46bda-151">Die Antworten auf die Fragen können Ihnen die Entscheidung für eine der Methoden – Hopanzahl, Nachrichtenweitergabefilter, lokaler Filter oder Direktverbindung – erleichtern.</span><span class="sxs-lookup"><span data-stu-id="46bda-151">The answers to these questions can help you determine whether to use Hop Count, a Message Propagation Filter, a local filter, or a direct connection.</span></span> <span data-ttu-id="46bda-152">Berücksichtigen Sie die folgenden allgemeinen Richtlinien:</span><span class="sxs-lookup"><span data-stu-id="46bda-152">Consider the following general guidelines:</span></span>

- <span data-ttu-id="46bda-153">**Möchten**</span><span class="sxs-lookup"><span data-stu-id="46bda-153">**Who**</span></span>

  - <span data-ttu-id="46bda-154">*Einzelner Knoten*: lokaler Filter oder direkte Verbindung.</span><span class="sxs-lookup"><span data-stu-id="46bda-154">*Individual node*:  Local filter or direct connection.</span></span>

  - <span data-ttu-id="46bda-155">*Nachbarn innerhalb einer bestimmten Nähe*: Peer-HopCount.</span><span class="sxs-lookup"><span data-stu-id="46bda-155">*Neighbors within a certain vicinity*:  PeerHopCount.</span></span>

  - <span data-ttu-id="46bda-156">*Komplexe Teilmenge des Mesh*: MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="46bda-156">*Complex subset of the mesh*:  MessagePropagationFilter.</span></span>

- <span data-ttu-id="46bda-157">**Wie häufig**</span><span class="sxs-lookup"><span data-stu-id="46bda-157">**How often**</span></span>

  - <span data-ttu-id="46bda-158">*Sehr häufig*: direkte Verbindung, PeerHopCount, MessagePropagationFilter.</span><span class="sxs-lookup"><span data-stu-id="46bda-158">*Very frequent*:  Direct connection, PeerHopCount, MessagePropagationFilter.</span></span>

  - <span data-ttu-id="46bda-159">*Gelegentlich*: lokaler Filter.</span><span class="sxs-lookup"><span data-stu-id="46bda-159">*Occasional*:  Local filter.</span></span>

- <span data-ttu-id="46bda-160">**Bandbreitenauslastung**</span><span class="sxs-lookup"><span data-stu-id="46bda-160">**Bandwidth use**</span></span>

  - <span data-ttu-id="46bda-161">*Hoch*: direkte Verbindung, weniger empfehlenswert für die Verwendung von MessagePropagationFilter oder lokalem Filter.</span><span class="sxs-lookup"><span data-stu-id="46bda-161">*High*:  Direct connection, less advisable to use MessagePropagationFilter or local filter.</span></span>

  - <span data-ttu-id="46bda-162">*Niedrig*: eine beliebige, direkte Verbindung ist wahrscheinlich nicht erforderlich.</span><span class="sxs-lookup"><span data-stu-id="46bda-162">*Low*:  Any, direct connection probably not needed.</span></span>

## <a name="see-also"></a><span data-ttu-id="46bda-163">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="46bda-163">See also</span></span>

- [<span data-ttu-id="46bda-164">Erstellen einer Peerkanalanwendung</span><span class="sxs-lookup"><span data-stu-id="46bda-164">Building a Peer Channel Application</span></span>](building-a-peer-channel-application.md)
