---
title: Implementierung eines serverseitigen Benutzeroberflächenautomatisierungs-Anbieters
description: Erfahren Sie, wie Sie einen serverseitigen Benutzeroberflächenautomatisierungs-Anbieter für ein benutzerdefiniertes Steuerelement in .NET implementieren. Die Implementierung für WPF-und nicht-WPF-Elemente ist unterschiedlich.
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: ee9fe5b3180abcc9ecbc4515e0af1e1c4b2e8b87
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/15/2020
ms.locfileid: "90555431"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="84845-104">Implementierung eines serverseitigen Benutzeroberflächenautomatisierungs-Anbieters</span><span class="sxs-lookup"><span data-stu-id="84845-104">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="84845-105">Diese Dokumentation ist für .NET Framework-Entwickler vorgesehen, die die verwalteten [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]-Klassen verwenden möchten, die im <xref:System.Windows.Automation>-Namespace definiert sind.</span><span class="sxs-lookup"><span data-stu-id="84845-105">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="84845-106">Aktuelle Informationen zur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]finden Sie auf der Seite zur [Windows-Automatisierungs-API: UI-Automatisierung](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="84845-106">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="84845-107">In diesem Abschnitt wird beschrieben, wie ein serverseitiger Benutzeroberflächenautomatisierungs-Anbieter für ein benutzerdefiniertes Steuerelement implementiert wird.</span><span class="sxs-lookup"><span data-stu-id="84845-107">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="84845-108">Die Implementierung für Windows Presentation Foundation (WPF)-Elemente und nicht-WPF-Elemente (z. b. die für Windows Forms vorgesehenen) unterscheiden sich grundlegend.</span><span class="sxs-lookup"><span data-stu-id="84845-108">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for Windows Forms) is fundamentally different.</span></span> <span data-ttu-id="84845-109">WPF-Elemente unterstützen [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] über eine von abgeleitete Klasse <xref:System.Windows.Automation.Peers.AutomationPeer> .</span><span class="sxs-lookup"><span data-stu-id="84845-109">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="84845-110">Nicht-WPF-Elemente bieten Unterstützung durch Implementierungen von Anbieter Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="84845-110">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="84845-111">Sicherheitsüberlegungen</span><span class="sxs-lookup"><span data-stu-id="84845-111">Security Considerations</span></span>

<span data-ttu-id="84845-112">Anbieter sollten so erstellt werden, dass sie in einer teilweise vertrauenswürdigen Umgebung funktionieren können.</span><span class="sxs-lookup"><span data-stu-id="84845-112">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="84845-113">Da UIAutomationClient.dll nicht für die Ausführung mit teilweiser Vertrauenswürdigkeit konfiguriert ist, sollte der Anbietercode nicht auf diese Assembly verweisen.</span><span class="sxs-lookup"><span data-stu-id="84845-113">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="84845-114">Wenn dies der Fall ist, kann der Code in einer voll vertrauenswürdigen Umgebung ausgeführt werden, während in einer teilweise vertrauenswürdigen Umgebung Fehler auftreten.</span><span class="sxs-lookup"><span data-stu-id="84845-114">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="84845-115">Verwenden Sie insbesondere keine Felder von Klassen in UIAutomationClient.dll, z. B. die Felder in <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="84845-115">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="84845-116">Verwenden Sie stattdessen die entsprechenden Felder der Klassen in UIAutomationTypes.dll, z. B. <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span><span class="sxs-lookup"><span data-stu-id="84845-116">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="84845-117">Anbieterimplementierung durch Windows Presentation Foundation-Elemente</span><span class="sxs-lookup"><span data-stu-id="84845-117">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="84845-118">Weitere Informationen zu diesem Thema finden Sie unter [Benutzeroberflächenautomatisierung eines benutzerdefinierten WPF-Steuerelements](/dotnet/desktop/wpf/controls/ui-automation-of-a-wpf-custom-control).</span><span class="sxs-lookup"><span data-stu-id="84845-118">For more information on this topic, please see [UI Automation of a WPF Custom Control](/dotnet/desktop/wpf/controls/ui-automation-of-a-wpf-custom-control).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="84845-119">Anbieterimplementierung durch Nicht-WPF-Elemente</span><span class="sxs-lookup"><span data-stu-id="84845-119">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="84845-120">Benutzerdefinierte Steuerelemente, die nicht Teil des WPF-Frameworks, jedoch in verwaltetem Code geschrieben sind (meistens handelt es sich hierbei um Windows Forms-Steuerelemente), unterstützen [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] durch das Implementieren von Schnittstellen.</span><span class="sxs-lookup"><span data-stu-id="84845-120">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are Windows Forms controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="84845-121">Jedes Element muss mindestens eine der in der ersten Tabelle des nächsten Abschnitts aufgeführten Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="84845-121">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="84845-122">Außerdem muss ein Element, das ein oder mehrere Steuerelementmuster unterstützt, für jedes Steuerelementmuster die entsprechende Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="84845-122">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="84845-123">Das [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] --Anbieterprojekt muss auf die folgenden Assemblys verweisen:</span><span class="sxs-lookup"><span data-stu-id="84845-123">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="84845-124">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="84845-124">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="84845-125">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="84845-125">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="84845-126">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="84845-126">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="84845-127">Anbieterschnittstellen</span><span class="sxs-lookup"><span data-stu-id="84845-127">Provider Interfaces</span></span>

<span data-ttu-id="84845-128">Jeder [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Anbieter muss eine der folgenden Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="84845-128">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="84845-129">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="84845-129">Interface</span></span>|<span data-ttu-id="84845-130">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="84845-130">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="84845-131">Stellt Funktionen für ein einfaches in einem Fenster gehostetes Steuerelement bereit, einschließlich der Unterstützung für Steuerelementmuster und Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="84845-131">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="84845-132">Erbt von <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span><span class="sxs-lookup"><span data-stu-id="84845-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="84845-133">Fügt Funktionen für ein Element in einem komplexen Steuerelement hinzu, einschließlich Navigation im Fragment, Festlegen des Fokus und Zurückgeben des umschließenden Rechtecks des Elements.</span><span class="sxs-lookup"><span data-stu-id="84845-133">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="84845-134">Erbt von <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span><span class="sxs-lookup"><span data-stu-id="84845-134">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="84845-135">Fügt Funktionen für das Stammelement in einem komplexen Steuerelement hinzu, einschließlich Suchen eines untergeordneten Elements an angegebenen Koordinaten und Festlegen des Fokuszustands für das gesamte Steuerelement.</span><span class="sxs-lookup"><span data-stu-id="84845-135">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="84845-136">Die folgenden Schnittstellen stellen weitere Funktionen bereit, müssen jedoch nicht implementiert werden.</span><span class="sxs-lookup"><span data-stu-id="84845-136">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="84845-137">Schnittstelle</span><span class="sxs-lookup"><span data-stu-id="84845-137">Interface</span></span>|<span data-ttu-id="84845-138">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="84845-138">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="84845-139">Ermöglicht dem Anbieter, Anforderungen für Ereignisse zu verfolgen.</span><span class="sxs-lookup"><span data-stu-id="84845-139">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="84845-140">Ermöglicht das Neupositionieren von fensterbasierten Elementen innerhalb der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Struktur eines Fragments.</span><span class="sxs-lookup"><span data-stu-id="84845-140">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="84845-141">Alle anderen Schnittstellen im <xref:System.Windows.Automation.Provider> -Namespace dienen der Unterstützung von Steuerelementmustern.</span><span class="sxs-lookup"><span data-stu-id="84845-141">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="84845-142">Anforderungen für Nicht-WPF-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-142">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="84845-143">Um mit [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]zu kommunizieren, muss ein Steuerelement die folgenden Hauptfunktionalitätsbereiche implementieren:</span><span class="sxs-lookup"><span data-stu-id="84845-143">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="84845-144">Funktionalität</span><span class="sxs-lookup"><span data-stu-id="84845-144">Functionality</span></span>|<span data-ttu-id="84845-145">Implementierung</span><span class="sxs-lookup"><span data-stu-id="84845-145">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="84845-146">Verfügbarmachen des Anbieters für [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="84845-146">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="84845-147">Antworten Sie auf eine an das Steuerelementfenster gesendete WM_GETOBJECT-Nachricht, indem Sie das Objekt zurückgeben, das <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (oder eine abgeleitete Schnittstelle) implementiert.</span><span class="sxs-lookup"><span data-stu-id="84845-147">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="84845-148">Für Fragmente muss dies der Anbieter für den Fragmentstamm sein.</span><span class="sxs-lookup"><span data-stu-id="84845-148">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="84845-149">Bereitstellen von Eigenschaftswerten</span><span class="sxs-lookup"><span data-stu-id="84845-149">Provide property values</span></span>|<span data-ttu-id="84845-150">Implementieren Sie <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> , um Werte bereitzustellen oder zu überschreiben.</span><span class="sxs-lookup"><span data-stu-id="84845-150">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="84845-151">Ermöglichen der Interaktion des Clients mit dem Steuerelement</span><span class="sxs-lookup"><span data-stu-id="84845-151">Enable the client to interact with the control</span></span>|<span data-ttu-id="84845-152">Implementieren Sie Schnittstellen, die Steuerelementmuster unterstützen, z. B. <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="84845-152">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="84845-153">Geben Sie diese Musteranbieter in der Implementierung von <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>zurück.</span><span class="sxs-lookup"><span data-stu-id="84845-153">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="84845-154">Auslösen von Ereignissen</span><span class="sxs-lookup"><span data-stu-id="84845-154">Raise events</span></span>|<span data-ttu-id="84845-155">Rufen Sie eine der statischen Methoden von <xref:System.Windows.Automation.Provider.AutomationInteropProvider> auf, um ein Ereignis auszulösen, das ein Client überwachen kann.</span><span class="sxs-lookup"><span data-stu-id="84845-155">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="84845-156">Ermöglichen der Navigation und Fokussierung in einem Fragment</span><span class="sxs-lookup"><span data-stu-id="84845-156">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="84845-157">Implementieren Sie <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> für jedes Element innerhalb des Fragments.</span><span class="sxs-lookup"><span data-stu-id="84845-157">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="84845-158">(Nicht für Elemente erforderlich, die kein Teil eines Fragments sind.)</span><span class="sxs-lookup"><span data-stu-id="84845-158">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="84845-159">Ermöglichen der Fokussierung und Positionierung eines untergeordneten Elements in einem Fragment</span><span class="sxs-lookup"><span data-stu-id="84845-159">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="84845-160">Implementieren Sie <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span><span class="sxs-lookup"><span data-stu-id="84845-160">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="84845-161">(Nicht für Elemente erforderlich, die keine Fragmentstämme sind.)</span><span class="sxs-lookup"><span data-stu-id="84845-161">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="84845-162">Eigenschaftswerte in Nicht-WPF-Anbietern</span><span class="sxs-lookup"><span data-stu-id="84845-162">Property Values in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="84845-163">-Anbieter für benutzerdefinierte Steuerelemente müssen bestimmte Eigenschaften unterstützen, die sowohl vom Automatisierungssystem als auch von Clientanwendungen verwendet werden können.</span><span class="sxs-lookup"><span data-stu-id="84845-163">providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="84845-164">Bei in Fenstern gehosteten Elementen (HWNDs) kann die [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] einige Eigenschaften vom Standardfensteranbieter abrufen, andere müssen jedoch vom benutzerdefinierten Anbieter bezogen werden.</span><span class="sxs-lookup"><span data-stu-id="84845-164">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="84845-165">Anbieter für HWND-basierte Steuerelemente müssen die folgenden Eigenschaften (identifiziert nach Feldwerten) normalerweise nicht bereitstellen:</span><span class="sxs-lookup"><span data-stu-id="84845-165">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="84845-166">Die <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> eines in einem Fenster gehosteten einfachen Elements oder Fragmentstamms wird vom Fenster bezogen. Fragmentelemente unterhalb des Stamms (wie Listeneinträge in einem Listenfeld) müssen jedoch eigene Bezeichner bereitstellen.</span><span class="sxs-lookup"><span data-stu-id="84845-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="84845-167">Weitere Informationen finden Sie unter <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="84845-167">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="84845-168">Die <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> sollte für Anbieter zurückgegeben werden, die in einem Windows Forms-Steuerelement gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="84845-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a Windows Forms control.</span></span> <span data-ttu-id="84845-169">In diesem Fall ist der Standardfensteranbieter möglicherweise nicht in der Lage, den richtigen Wert abzurufen.</span><span class="sxs-lookup"><span data-stu-id="84845-169">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="84845-170">Die <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> wird in der Regel vom Hostanbieter bereitgestellt.</span><span class="sxs-lookup"><span data-stu-id="84845-170">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="84845-171">Wenn ein benutzerdefiniertes Steuerelement beispielsweise von <xref:System.Windows.Forms.Control>abgeleitet ist, wird der Name von der `Text` -Eigenschaft des Steuerelements abgeleitet</span><span class="sxs-lookup"><span data-stu-id="84845-171">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="84845-172">Beispielcode finden Sie unter [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="84845-172">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="84845-173">Ereignisse in Nicht-WPF-Anbietern</span><span class="sxs-lookup"><span data-stu-id="84845-173">Events in Non-WPF Providers</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="84845-174">-Anbieter sollten Ereignisse auslösen, um Clientanwendungen über Zustandsänderungen der Benutzeroberfläche zu benachrichtigen.</span><span class="sxs-lookup"><span data-stu-id="84845-174">providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="84845-175">Ereignisse werden mit den folgenden Methoden ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="84845-175">The following methods are used to raise events.</span></span>

|<span data-ttu-id="84845-176">Methode</span><span class="sxs-lookup"><span data-stu-id="84845-176">Method</span></span>|<span data-ttu-id="84845-177">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="84845-177">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="84845-178">Löst verschiedene Ereignisse aus, einschließlich Ereignissen, die von Steuerelementmustern ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="84845-178">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="84845-179">Löst ein Ereignis aus, wenn sich eine [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Eigenschaft geändert hat.</span><span class="sxs-lookup"><span data-stu-id="84845-179">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="84845-180">Löst ein Ereignis aus, wenn sich der Aufbau der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Struktur geändert hat, z. B. durch Entfernen oder Hinzufügen eines Elements.</span><span class="sxs-lookup"><span data-stu-id="84845-180">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="84845-181">Der Zweck eines Ereignisses liegt im Benachrichtigen des Clients über Vorgänge in der [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], unabhängig davon, ob eine Aktion vom [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -System selbst ausgelöst wird.</span><span class="sxs-lookup"><span data-stu-id="84845-181">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="84845-182">Beispielsweise sollte das von <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> identifizierte Ereignis immer ausgelöst werden, wenn das Steuerelement aufgerufen wird, unabhängig davon, ob durch eine direkte Benutzereingabe oder durch die <xref:System.Windows.Automation.InvokePattern.Invoke%2A>aufrufende Clientanwendung.</span><span class="sxs-lookup"><span data-stu-id="84845-182">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="84845-183">Zum Optimieren der Leistung kann ein Anbieter Ereignisse selektiv auslösen oder keine Ereignisse auslösen, wenn für deren Empfang keine Clientanwendung registriert ist.</span><span class="sxs-lookup"><span data-stu-id="84845-183">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="84845-184">Die folgenden Methoden werden zur Optimierung verwendet.</span><span class="sxs-lookup"><span data-stu-id="84845-184">The following methods are used for optimization.</span></span>

|<span data-ttu-id="84845-185">Methode</span><span class="sxs-lookup"><span data-stu-id="84845-185">Method</span></span>|<span data-ttu-id="84845-186">BESCHREIBUNG</span><span class="sxs-lookup"><span data-stu-id="84845-186">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="84845-187">Diese statische Eigenschaft gibt an, ob es Clientanwendungen gibt, die [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Ereignisse abonniert haben.</span><span class="sxs-lookup"><span data-stu-id="84845-187">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="84845-188">Durch die Implementierung dieser Schnittstelle durch den Anbieter auf einem Fragmentstamm kann kommuniziert werden, wenn Clients Registrierungen von Ereignishandlern für Ereignisse im Fragment vornehmen bzw. aufheben.</span><span class="sxs-lookup"><span data-stu-id="84845-188">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="84845-189">Navigation für Nicht-WPF-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-189">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="84845-190">Anbieter für einfache Steuerelemente, z. B. eine benutzerdefinierte Schaltfläche, die in einem Fenster (HWND) gehostet wird, müssen die Navigation innerhalb der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Struktur nicht unterstützen.</span><span class="sxs-lookup"><span data-stu-id="84845-190">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="84845-191">Die Navigation zum und vom Element wird vom Standardanbieter für das Hostfenster verarbeitet, der in der Implementierung von <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>angegeben ist.</span><span class="sxs-lookup"><span data-stu-id="84845-191">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="84845-192">Wenn Sie jedoch einen Anbieter für ein komplexes benutzerdefiniertes Steuerelement implementieren, müssen Sie die Navigation zwischen dem Stammknoten des Fragments und seinen Nachfolgern sowie zwischen nebengeordneten Knoten unterstützen.</span><span class="sxs-lookup"><span data-stu-id="84845-192">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="84845-193">Die Nicht-Stammelemente eines Fragments müssen einen `null` -Verweis von <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>zurückgeben, da sie nicht direkt in einem Fenster gehostet werden und die Navigation zu und von ihnen von keinem Standardanbieter unterstützt werden kann.</span><span class="sxs-lookup"><span data-stu-id="84845-193">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="84845-194">Die Struktur des Fragments wird durch Ihre Implementierung von <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>festgelegt.</span><span class="sxs-lookup"><span data-stu-id="84845-194">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="84845-195">Diese Methode gibt für jedes Fragment und jede mögliche Richtung das Anbieterobjekt für das in dieser Richtung liegende Element zurück.</span><span class="sxs-lookup"><span data-stu-id="84845-195">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="84845-196">Wenn in einer Richtung kein Element vorhanden ist, gibt die Methode einen `null` -Verweis zurück.</span><span class="sxs-lookup"><span data-stu-id="84845-196">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="84845-197">Der Fragmentstamm unterstützt nur die Navigation zu untergeordneten Elementen.</span><span class="sxs-lookup"><span data-stu-id="84845-197">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="84845-198">Beispielsweise gibt ein Listenfeld für die Richtung <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>den ersten Eintrag und für die Richtung <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>den letzten Eintrag in der Liste zurück.</span><span class="sxs-lookup"><span data-stu-id="84845-198">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="84845-199">Der Fragmentstamm unterstützt keine Navigation zu einem übergeordneten oder nebengeordneten Element; diese wird vom Hostfensteranbieter verarbeitet.</span><span class="sxs-lookup"><span data-stu-id="84845-199">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="84845-200">Die Nicht-Stammelemente eines Fragments müssen die Navigation zum übergeordneten Element sowie zu allen vorhandenen nebengeordneten und untergeordneten Elementen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="84845-200">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="84845-201">Neuzuordnung des übergeordneten Elements für Nicht-WPF-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-201">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="84845-202">Genau genommen sind Popupfenster Fenster oberster Ebene und werden in der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Struktur standardmäßig als untergeordnete Elemente des Desktops angezeigt.</span><span class="sxs-lookup"><span data-stu-id="84845-202">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="84845-203">Eigentlich sind Popupfenster in vielen Fällen jedoch untergeordnete Elemente anderer Steuerelemente.</span><span class="sxs-lookup"><span data-stu-id="84845-203">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="84845-204">Beispielsweise ist die Dropdownliste eines Kombinationsfelds logischerweise ein untergeordnetes Element des Kombinationsfelds.</span><span class="sxs-lookup"><span data-stu-id="84845-204">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="84845-205">Dementsprechend ist ein Menüpopupfenster logischerweise ein untergeordnetes Element des Menüs.</span><span class="sxs-lookup"><span data-stu-id="84845-205">Similarly, a menu pop-up window is logically a child of the menu.</span></span> <span data-ttu-id="84845-206">Die[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] unterstützt für Popupfenster das Neuzuordnen des übergeordneten Elements, sodass sie als untergeordnete Elemente des zugehörigen Steuerelements angezeigt werden.</span><span class="sxs-lookup"><span data-stu-id="84845-206">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="84845-207">So ordnen Sie ein Popupfenster einem neuen übergeordneten Element zu</span><span class="sxs-lookup"><span data-stu-id="84845-207">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="84845-208">Erstellen Sie einen Anbieter für das Popupfenster.</span><span class="sxs-lookup"><span data-stu-id="84845-208">Create a provider for the pop-up window.</span></span> <span data-ttu-id="84845-209">Hierfür muss die Klasse des Popupfensters im Voraus bekannt sein.</span><span class="sxs-lookup"><span data-stu-id="84845-209">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="84845-210">Implementieren Sie für das Popupfenster alle Eigenschaften und Muster, als ob es ein vollkommen eigenständiges Steuerelement ist.</span><span class="sxs-lookup"><span data-stu-id="84845-210">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="84845-211">Implementieren Sie die <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> -Eigenschaft, sodass sie den mit <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>abgerufenen Wert zurückgibt. Der Parameter ist hierbei der Fensterhandle des Popupfensters.</span><span class="sxs-lookup"><span data-stu-id="84845-211">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="84845-212">Implementieren Sie für das Popupfenster und das übergeordnete Element <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> , sodass die Navigation vom logischen übergeordneten Element zum logischen untergeordneten Element sowie zwischen den nebengeordneten Elementen ordnungsgemäß verarbeitet wird.</span><span class="sxs-lookup"><span data-stu-id="84845-212">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="84845-213">Wenn die [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] auf das Popupfenster als untergeordnetes Element des Desktops stößt, wird erkannt, dass die Standardnavigation überschrieben wurde, und das Popupfenster wird übersprungen.</span><span class="sxs-lookup"><span data-stu-id="84845-213">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="84845-214">Stattdessen ist der Knoten nur über das Fragment erreichbar.</span><span class="sxs-lookup"><span data-stu-id="84845-214">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="84845-215">Das Neuzuordnen des übergeordneten Elements ist nicht geeignet, wenn ein Steuerelement ein Fenster einer beliebigen Klasse hosten kann.</span><span class="sxs-lookup"><span data-stu-id="84845-215">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="84845-216">Beispielsweise kann in den Bändern einer Grundleiste jeder HWND-Typ gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="84845-216">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="84845-217">Für solche Fälle unterstützt die [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] eine alternative Form der HWND-Umsetzung. Diese wird im nächsten Abschnitt beschrieben.</span><span class="sxs-lookup"><span data-stu-id="84845-217">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="84845-218">Neupositionieren für Nicht-WPF-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-218">Non-WPF Provider Repositioning</span></span>

[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="84845-219">-Fragmente enthalten möglicherweise zwei oder mehr Elemente, die jeweils in einem Fenster (HWND) enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="84845-219">fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="84845-220">Da jedes HWND über einen eigenen Standardanbieter verfügt, der das HWND als ein untergeordnetes Element eines enthaltenden HWND ansieht, werden in der [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] -Struktur die HWNDs im Fragment standardmäßig als untergeordnete Elemente des übergeordneten Fensters angezeigt.</span><span class="sxs-lookup"><span data-stu-id="84845-220">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="84845-221">Dies ist in den meisten Fällen erwünscht. Manchmal kann es jedoch zu Verwirrung führen, da es nicht der logischen Struktur der [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]entspricht.</span><span class="sxs-lookup"><span data-stu-id="84845-221">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="84845-222">Ein gutes Beispiel hierfür ist ein Grundleistensteuerelement.</span><span class="sxs-lookup"><span data-stu-id="84845-222">A good example of this is a rebar control.</span></span> <span data-ttu-id="84845-223">Eine Grundleiste enthält Bänder, die jeweils ein HWND-basiertes Steuerelement wie eine Symbolleiste, ein Eingabefeld oder ein Kombinationsfeld enthalten können.</span><span class="sxs-lookup"><span data-stu-id="84845-223">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="84845-224">Für den Standardfensteranbieter für das Grundleisten-HWND sind die Bandsteuerelement-HWNDs untergeordnete Elemente, und für den Grundleistenanbieter sind die Bänder untergeordnete Elemente.</span><span class="sxs-lookup"><span data-stu-id="84845-224">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="84845-225">Da der HWND-Anbieter und der Grundleistenanbieter zusammenarbeiten und ihre untergeordneten Elemente kombinieren, werden sowohl die Bänder als auch die HWND-basierten Steuerelemente als untergeordnete Elemente der Grundleiste angezeigt.</span><span class="sxs-lookup"><span data-stu-id="84845-225">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="84845-226">Es sollten jedoch logischerweise nur die Bänder als untergeordnete Elemente der Grundleiste angezeigt werden, und jeder Bandanbieter sollte mit dem Standard-HWND-Anbieter für das enthaltene Steuerelement verbunden werden.</span><span class="sxs-lookup"><span data-stu-id="84845-226">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="84845-227">Hierfür stellt der Fragmentstammanbieter für die Grundleiste einen Satz an untergeordneten Elementen zur Verfügung, die die Bänder repräsentieren.</span><span class="sxs-lookup"><span data-stu-id="84845-227">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="84845-228">Jedes Band verfügt über einen einzelnen Anbieter, der Eigenschaften und Muster zur Verfügung stellen kann.</span><span class="sxs-lookup"><span data-stu-id="84845-228">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="84845-229">In dessen Implementierung von <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>gibt der Bandanbieter den Standardfensteranbieter für das Steuerelement-HWND zurück, den er unter Übergabe des Fensterhandles des Steuerelements mithilfe von <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>abruft.</span><span class="sxs-lookup"><span data-stu-id="84845-229">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="84845-230">Abschließend implementiert der Fragmentstammanbieter für die Infoleiste die <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> -Schnittstelle, und gibt in seiner Implementierung von <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> den geeigneten Bandanbieter für das im angegebenen HWND enthaltene Steuerelement zurück.</span><span class="sxs-lookup"><span data-stu-id="84845-230">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="84845-231">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="84845-231">See also</span></span>

- [<span data-ttu-id="84845-232">Übersicht über die Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-232">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="84845-233">Verfügbarmachen eines serverseitigen Benutzeroberflächenautomatisierungs-Anbieters</span><span class="sxs-lookup"><span data-stu-id="84845-233">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="84845-234">Zurückgeben von Eigenschaften aus einem Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-234">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="84845-235">Auslösen von Ereignissen aus einem Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-235">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="84845-236">Aktivieren der Navigation in einem Benutzeroberflächenautomatisierungs-Fragmentanbieter</span><span class="sxs-lookup"><span data-stu-id="84845-236">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="84845-237">Unterstützung von Steuerelementmustern in einem Benutzeroberflächenautomatisierungs-Anbieter</span><span class="sxs-lookup"><span data-stu-id="84845-237">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
