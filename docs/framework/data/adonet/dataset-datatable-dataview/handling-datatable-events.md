---
title: Behandeln von DataTable-Ereignissen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 62f404a5-13ea-4b93-a29f-55b74a16c9d3
ms.openlocfilehash: c00e5e42508160a210d16f058c46afbf62ae0ee0
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/24/2020
ms.locfileid: "91164726"
---
# <a name="handling-datatable-events"></a><span data-ttu-id="8a68a-102">Behandeln von DataTable-Ereignissen</span><span class="sxs-lookup"><span data-stu-id="8a68a-102">Handling DataTable Events</span></span>

<span data-ttu-id="8a68a-103">Das <xref:System.Data.DataTable>-Objekt stellt eine Reihe von Ereignissen bereit, die von einer Anwendung verarbeitet werden können.</span><span class="sxs-lookup"><span data-stu-id="8a68a-103">The <xref:System.Data.DataTable> object provides a series of events that can be processed by an application.</span></span> <span data-ttu-id="8a68a-104">Eine Beschreibung dieser `DataTable`-Ereignisse finden Sie in der folgenden Tabelle:</span><span class="sxs-lookup"><span data-stu-id="8a68a-104">The following table describes `DataTable` events.</span></span>  
  
|<span data-ttu-id="8a68a-105">Ereignis</span><span class="sxs-lookup"><span data-stu-id="8a68a-105">Event</span></span>|<span data-ttu-id="8a68a-106">Beschreibung</span><span class="sxs-lookup"><span data-stu-id="8a68a-106">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Data.DataTable.Initialized>|<span data-ttu-id="8a68a-107">Tritt ein, nachdem die <xref:System.Data.DataTable.EndInit%2A>-Methode einer `DataTable` aufgerufen wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-107">Occurs after the <xref:System.Data.DataTable.EndInit%2A> method of a `DataTable` is called.</span></span> <span data-ttu-id="8a68a-108">Dieses Ereignis ist hauptsächlich zur Unterstützung von Szenarien zur Entwurfszeit gedacht.</span><span class="sxs-lookup"><span data-stu-id="8a68a-108">This event is intended primarily to support design-time scenarios.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanged>|<span data-ttu-id="8a68a-109">Tritt ein, nachdem ein Wert in einer <xref:System.Data.DataColumn> erfolgreich geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-109">Occurs after a value has been successfully changed in a <xref:System.Data.DataColumn>.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanging>|<span data-ttu-id="8a68a-110">Tritt ein, wenn ein Wert für eine `DataColumn` übermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-110">Occurs when a value has been submitted for a `DataColumn`.</span></span>|  
|<xref:System.Data.DataTable.RowChanged>|<span data-ttu-id="8a68a-111">Tritt ein, nachdem ein `DataColumn`-Wert oder der <xref:System.Data.DataRow.RowState%2A> einer <xref:System.Data.DataRow> in der `DataTable` erfolgreich geändert wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-111">Occurs after a `DataColumn` value or the <xref:System.Data.DataRow.RowState%2A> of a <xref:System.Data.DataRow> in the `DataTable` has been changed successfully.</span></span>|  
|<xref:System.Data.DataTable.RowChanging>|<span data-ttu-id="8a68a-112">Tritt ein, wenn eine Änderung für einen `DataColumn`-Wert oder für den `RowState` einer `DataRow` in der `DataTable` übermittelt wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-112">Occurs when a change has been submitted for a `DataColumn` value or the `RowState` of a `DataRow` in the `DataTable`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleted>|<span data-ttu-id="8a68a-113">Tritt ein, nachdem eine `DataRow` in der `DataTable` als `Deleted` gekennzeichnet wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-113">Occurs after a `DataRow` in the `DataTable` has been marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleting>|<span data-ttu-id="8a68a-114">Tritt ein, bevor eine `DataRow` in der `DataTable` als `Deleted` gekennzeichnet wird.</span><span class="sxs-lookup"><span data-stu-id="8a68a-114">Occurs before a `DataRow` in the `DataTable` is marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.TableCleared>|<span data-ttu-id="8a68a-115">Tritt ein, nachdem ein Aufruf der <xref:System.Data.DataTable.Clear%2A>-Methode der `DataTable` jede `DataRow` erfolgreich gelöscht hat.</span><span class="sxs-lookup"><span data-stu-id="8a68a-115">Occurs after a call to the <xref:System.Data.DataTable.Clear%2A> method of the `DataTable` has successfully cleared every `DataRow`.</span></span>|  
|<xref:System.Data.DataTable.TableClearing>|<span data-ttu-id="8a68a-116">Tritt ein, nachdem die `Clear`-Methode aufgerufen wurde, aber bevor der `Clear`-Vorgang beginnt.</span><span class="sxs-lookup"><span data-stu-id="8a68a-116">Occurs after the `Clear` method is called but before the `Clear` operation begins.</span></span>|  
|<xref:System.Data.DataTable.TableNewRow>|<span data-ttu-id="8a68a-117">Tritt ein, nachdem durch einen Aufruf der `DataRow`-Methode der `NewRow` eine neue `DataTable` erstellt wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-117">Occurs after a new `DataRow` is created by a call to the `NewRow` method of the `DataTable`.</span></span>|  
|<xref:System.ComponentModel.MarshalByValueComponent.Disposed>|<span data-ttu-id="8a68a-118">Tritt ein, wenn die `DataTable` in den `Disposed`-Status versetzt wurde.</span><span class="sxs-lookup"><span data-stu-id="8a68a-118">Occurs when the `DataTable` is `Disposed`.</span></span> <span data-ttu-id="8a68a-119">Wird von <xref:System.ComponentModel.MarshalByValueComponent> geerbt.</span><span class="sxs-lookup"><span data-stu-id="8a68a-119">Inherited from <xref:System.ComponentModel.MarshalByValueComponent>.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="8a68a-120">Die meisten Operationen, die Zeilen hinzufügen oder löschen, führen nicht zum Auslösen der Ereignisse `ColumnChanged` und `ColumnChanging`.</span><span class="sxs-lookup"><span data-stu-id="8a68a-120">Most operations that add or delete rows do not raise the `ColumnChanged` and `ColumnChanging` events.</span></span> <span data-ttu-id="8a68a-121">Die `ReadXml`-Methode löst jedoch weiterhin das `ColumnChanged`-Ereignis und das `ColumnChanging`-Ereignis aus, bis `XmlReadMode` auf `DiffGram` oder auf `Auto` festgelegt ist, wenn das gelesene XML-Dokument ein `DiffGram` ist.</span><span class="sxs-lookup"><span data-stu-id="8a68a-121">However, the `ReadXml` method does raise `ColumnChanged` and `ColumnChanging` events, unless the `XmlReadMode` is set to `DiffGram` or is set to `Auto` when the XML document being read is a `DiffGram`.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="8a68a-122">Wenn Daten in einem `DataSet` geändert werden, über das das `RowChanged`-Ereignis ausgelöst wird, können Daten beschädigt werden.</span><span class="sxs-lookup"><span data-stu-id="8a68a-122">Data corruption can occur if data is modified in a `DataSet` from which the `RowChanged` event is raised.</span></span> <span data-ttu-id="8a68a-123">Bei einer solchen Datenbeschädigung wird keine Ausnahme ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8a68a-123">No exception will be raised if such data corruption occurs.</span></span>  
  
## <a name="additional-related-events"></a><span data-ttu-id="8a68a-124">Weitere verwandte Ereignisse</span><span class="sxs-lookup"><span data-stu-id="8a68a-124">Additional Related Events</span></span>  

 <span data-ttu-id="8a68a-125">Die <xref:System.Data.DataTable.Constraints%2A>-Eigenschaft enthält eine <xref:System.Data.ConstraintCollection>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="8a68a-125">The <xref:System.Data.DataTable.Constraints%2A> property holds a <xref:System.Data.ConstraintCollection> instance.</span></span> <span data-ttu-id="8a68a-126">Die <xref:System.Data.ConstraintCollection>-Klasse macht ein <xref:System.Data.ConstraintCollection.CollectionChanged>-Ereignis verfügbar.</span><span class="sxs-lookup"><span data-stu-id="8a68a-126">The <xref:System.Data.ConstraintCollection> class exposes a <xref:System.Data.ConstraintCollection.CollectionChanged> event.</span></span> <span data-ttu-id="8a68a-127">Dieses Ereignis wird ausgelöst, wenn eine Einschränkung hinzugefügt, geändert oder aus der `ConstraintCollection` entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="8a68a-127">This event fires when a constraint is added, modified, or removed from the `ConstraintCollection`.</span></span>  
  
 <span data-ttu-id="8a68a-128">Die <xref:System.Data.DataTable.Columns%2A>-Eigenschaft enthält eine <xref:System.Data.DataColumnCollection>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="8a68a-128">The <xref:System.Data.DataTable.Columns%2A> property holds a <xref:System.Data.DataColumnCollection> instance.</span></span> <span data-ttu-id="8a68a-129">Die `DataColumnCollection`-Klasse macht ein <xref:System.Data.DataColumnCollection.CollectionChanged>-Ereignis verfügbar.</span><span class="sxs-lookup"><span data-stu-id="8a68a-129">The `DataColumnCollection` class exposes a <xref:System.Data.DataColumnCollection.CollectionChanged> event.</span></span> <span data-ttu-id="8a68a-130">Dieses Ereignis wird ausgelöst, wenn eine `DataColumn` hinzugefügt, geändert oder aus der `DataColumnCollection` entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="8a68a-130">This event fires when a `DataColumn` is added, modified, or removed from the `DataColumnCollection`.</span></span> <span data-ttu-id="8a68a-131">Zu den Änderungen, die das Ereignis auslösen, gehören Änderungen des Namens, des Typs, des Ausdrucks oder der Ordinalposition einer Spalte.</span><span class="sxs-lookup"><span data-stu-id="8a68a-131">Modifications that cause the event to fire include changes to the name, type, expression or ordinal position of a column.</span></span>  
  
 <span data-ttu-id="8a68a-132">Die <xref:System.Data.DataSet.Tables%2A>-Eigenschaft eines <xref:System.Data.DataSet> enthält eine <xref:System.Data.DataTableCollection>-Instanz.</span><span class="sxs-lookup"><span data-stu-id="8a68a-132">The <xref:System.Data.DataSet.Tables%2A> property of a <xref:System.Data.DataSet> holds a <xref:System.Data.DataTableCollection> instance.</span></span> <span data-ttu-id="8a68a-133">Die `DataTableCollection`-Klasse macht sowohl ein `CollectionChanged`-Ereignis als auch ein `CollectionChanging`-Ereignis verfügbar.</span><span class="sxs-lookup"><span data-stu-id="8a68a-133">The `DataTableCollection` class exposes both a `CollectionChanged` and a `CollectionChanging` event.</span></span> <span data-ttu-id="8a68a-134">Diese Ereignisse werden ausgelöst, wenn eine `DataTable` hinzugefügt oder aus dem `DataSet` entfernt wird.</span><span class="sxs-lookup"><span data-stu-id="8a68a-134">These events fire when a `DataTable` is added to or removed from the `DataSet`.</span></span>  
  
 <span data-ttu-id="8a68a-135">Änderungen an `DataRows` können auch Ereignisse für eine verknüpfte <xref:System.Data.DataView> auslösen.</span><span class="sxs-lookup"><span data-stu-id="8a68a-135">Changes to `DataRows` can also trigger events for an associated <xref:System.Data.DataView>.</span></span> <span data-ttu-id="8a68a-136">Die `DataView`-Klasse macht ein <xref:System.Data.DataView.ListChanged>-Ereignis verfügbar, das ausgelöst wird, wenn sich ein `DataColumn`-Wert ändert oder wenn sich die Zusammensetzung oder Sortierreihenfolge der Ansicht ändert.</span><span class="sxs-lookup"><span data-stu-id="8a68a-136">The `DataView` class exposes a <xref:System.Data.DataView.ListChanged> event that fires when a `DataColumn` value changes or when the composition or sort order of the view changes.</span></span> <span data-ttu-id="8a68a-137">Die <xref:System.Data.DataRowView>-Klasse macht ein <xref:System.Data.DataRowView.PropertyChanged>-Ereignis verfügbar, das ausgelöst wird, wenn sich ein verknüpfter `DataColumn`-Wert ändert.</span><span class="sxs-lookup"><span data-stu-id="8a68a-137">The <xref:System.Data.DataRowView> class exposes a <xref:System.Data.DataRowView.PropertyChanged> event that fires when an associated `DataColumn` value changes.</span></span>  
  
## <a name="sequence-of-operations"></a><span data-ttu-id="8a68a-138">Abfolge der Vorgänge</span><span class="sxs-lookup"><span data-stu-id="8a68a-138">Sequence of Operations</span></span>  

 <span data-ttu-id="8a68a-139">Beim Hinzufügen, Ändern oder Löschen einer `DataRow` laufen die Vorgänge in der folgenden Reihenfolge ab:</span><span class="sxs-lookup"><span data-stu-id="8a68a-139">Here is the sequence of operations that occur when a `DataRow` is added, modified, or deleted:</span></span>  
  
1. <span data-ttu-id="8a68a-140">Der vorgeschlagene Datensatz wird erstellt, und alle Änderungen werden übernommen.</span><span class="sxs-lookup"><span data-stu-id="8a68a-140">Create the proposed record and apply any changes.</span></span>  
  
2. <span data-ttu-id="8a68a-141">Die Einschränkungen für Nicht-Ausdruck-Spalten werden überprüft.</span><span class="sxs-lookup"><span data-stu-id="8a68a-141">Check constraints for non-expression columns.</span></span>  
  
3. <span data-ttu-id="8a68a-142">Das `RowChanging`-Ereignis oder das `RowDeleting`-Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8a68a-142">Raise the `RowChanging` or `RowDeleting` events as applicable.</span></span>  
  
4. <span data-ttu-id="8a68a-143">Der vorgeschlagene Datensatz wird als aktueller Datensatz festgelegt.</span><span class="sxs-lookup"><span data-stu-id="8a68a-143">Set the proposed record to be the current record.</span></span>  
  
5. <span data-ttu-id="8a68a-144">Alle zugeordneten Indizes werden aktualisiert.</span><span class="sxs-lookup"><span data-stu-id="8a68a-144">Update any associated indexes.</span></span>  
  
6. <span data-ttu-id="8a68a-145">Die `ListChanged`-Ereignisse für zugeordnete `DataView`-Objekte und die `PropertyChanged`-Ereignisse für zugeordnete `DataRowView`-Objekte werden ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8a68a-145">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects.</span></span>  
  
7. <span data-ttu-id="8a68a-146">Alle Ausdrucksspalten werden ausgewertet, wobei aber die Überprüfung der Einschränkungen für diese Spalten verzögert wird.</span><span class="sxs-lookup"><span data-stu-id="8a68a-146">Evaluate all expression columns, but delay checking any constraints on these columns.</span></span>  
  
8. <span data-ttu-id="8a68a-147">Die `ListChanged`-Ereignisse für die zugeordneten `DataView`-Objekte und die `PropertyChanged`-Ereignisse für die zugeordneten `DataRowView`-Objekte, auf die sich die Auswertung der Ausdrucksspalten auswirkt, werden ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8a68a-147">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects affected by the expression column evaluations.</span></span>  
  
9. <span data-ttu-id="8a68a-148">Das `RowChanged`-Ereignis oder das `RowDeleted`-Ereignis wird ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="8a68a-148">Raise `RowChanged` or `RowDeleted` events as applicable.</span></span>  
  
10. <span data-ttu-id="8a68a-149">Die Einschränkungen für Ausdrucksspalten werden überprüft.</span><span class="sxs-lookup"><span data-stu-id="8a68a-149">Check constraints on expression columns.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8a68a-150">Änderungen an Ausdrucksspalten führen nie dazu, dass `DataTable`-Ereignisse ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="8a68a-150">Changes to expression columns never raise `DataTable` events.</span></span> <span data-ttu-id="8a68a-151">Änderungen an Ausdrucksspalten lösen lediglich die Ereignisse `DataView` und `DataRowView` aus.</span><span class="sxs-lookup"><span data-stu-id="8a68a-151">Changes to expression columns only raise `DataView` and `DataRowView` events.</span></span> <span data-ttu-id="8a68a-152">Ausdrucksspalten können Abhängigkeiten von mehreren anderen Spalten besitzen und während eines einzelnen `DataRow`-Vorgangs mehrmals ausgewertet werden.</span><span class="sxs-lookup"><span data-stu-id="8a68a-152">Expression columns can have dependencies on multiple other columns, and can be evaluated multiple times during a single `DataRow` operation.</span></span> <span data-ttu-id="8a68a-153">Jede Ausdrucksauswertung löst Ereignisse aus, und ein einzelner `DataRow`-Vorgang kann mehrere `ListChanged`- und `PropertyChanged`-Ereignisse auslösen, sofern Ausdrucksspalten betroffen sind. Dabei ist es auch möglich, dass für ein und dieselbe Ausdrucksspalte mehrere Ereignisse ausgelöst werden.</span><span class="sxs-lookup"><span data-stu-id="8a68a-153">Each expression evaluation raises events, and a single `DataRow` operation can raise multiple `ListChanged` and `PropertyChanged` events when expression columns are affected, possibly including multiple events for the same expression column.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="8a68a-154">Lösen Sie keine <xref:System.NullReferenceException> im `RowChanged`-Ereignishandler aus.</span><span class="sxs-lookup"><span data-stu-id="8a68a-154">Do not throw a <xref:System.NullReferenceException> within the `RowChanged` event handler.</span></span> <span data-ttu-id="8a68a-155">Wenn eine <xref:System.NullReferenceException> im `RowChanged`-Ereignis einer `DataTable` ausgelöst wird, führt dies zur Beschädigung der `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="8a68a-155">If a <xref:System.NullReferenceException> is thrown within the `RowChanged` event of a `DataTable`, then the `DataTable` will be corrupted.</span></span>  
  
### <a name="example"></a><span data-ttu-id="8a68a-156">Beispiel</span><span class="sxs-lookup"><span data-stu-id="8a68a-156">Example</span></span>  

 <span data-ttu-id="8a68a-157">Das folgende Beispiel zeigt, wie Ereignishandler für die Ereignisse `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared` und `TableClearing` erstellt werden können.</span><span class="sxs-lookup"><span data-stu-id="8a68a-157">The following example demonstrates how to create event handlers for the `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared`, and `TableClearing` events.</span></span> <span data-ttu-id="8a68a-158">Jeder Ereignishandler zeigt die Ausgabe beim Auslösen der Ereignisse im Konsolenfenster an.</span><span class="sxs-lookup"><span data-stu-id="8a68a-158">Each event handler displays output in the console window when it is fired.</span></span>  
  
 [!code-csharp[DataWorks DataTable.Events#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataTable.Events/CS/source.cs#1)]
 [!code-vb[DataWorks DataTable.Events#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataTable.Events/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="8a68a-159">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="8a68a-159">See also</span></span>

- [<span data-ttu-id="8a68a-160">Bearbeiten von Daten in einer "DataTable"</span><span class="sxs-lookup"><span data-stu-id="8a68a-160">Manipulating Data in a DataTable</span></span>](manipulating-data-in-a-datatable.md)
- [<span data-ttu-id="8a68a-161">Behandeln von DataAdapter-Ereignissen</span><span class="sxs-lookup"><span data-stu-id="8a68a-161">Handling DataAdapter Events</span></span>](../handling-dataadapter-events.md)
- [<span data-ttu-id="8a68a-162">Behandeln von DataSet-Ereignissen</span><span class="sxs-lookup"><span data-stu-id="8a68a-162">Handling DataSet Events</span></span>](handling-dataset-events.md)
- [<span data-ttu-id="8a68a-163">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="8a68a-163">ADO.NET Overview</span></span>](../ado-net-overview.md)
