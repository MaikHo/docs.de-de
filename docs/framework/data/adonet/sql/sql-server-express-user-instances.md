---
title: SQL Server Express-Benutzerinstanzen
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: 401b62f56918e8ac406a5ee2dda2252d328592bc
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/24/2020
ms.locfileid: "91147579"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="99721-102">SQL Server Express-Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="99721-102">SQL Server Express User Instances</span></span>

<span data-ttu-id="99721-103">Microsoft SQL Server Express Edition (SQL Server Express) unterstützt die Benutzerinstanzfunktion, die die Verwendung des .NET Framework-Datenanbieters für SQL Server (`SqlClient`) voraussetzt.</span><span class="sxs-lookup"><span data-stu-id="99721-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="99721-104">Eine Benutzerinstanz ist eine separate Instanz der SQL Server Express-Datenbank-Engine, die von einer übergeordneten Instanz generiert wird.</span><span class="sxs-lookup"><span data-stu-id="99721-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="99721-105">Benutzerinstanzen ermöglichen Benutzern, die keine Administratoren auf ihren lokalen Computern sind, eine Verbindung mit SQL Server Express-Datenbanken herzustellen.</span><span class="sxs-lookup"><span data-stu-id="99721-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="99721-106">Jede Instanz wird im Sicherheitskontext des jeweiligen Benutzers auf instanz- und benutzerbezogener Basis ausgeführt.</span><span class="sxs-lookup"><span data-stu-id="99721-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="99721-107">Was können Benutzerinstanzen?</span><span class="sxs-lookup"><span data-stu-id="99721-107">User Instance Capabilities</span></span>  

 <span data-ttu-id="99721-108">Benutzer Instanzen sind nützlich für Benutzer, die Windows unter einem Benutzerkonto mit geringsten Rechten (LUA) ausführen.</span><span class="sxs-lookup"><span data-stu-id="99721-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA).</span></span> <span data-ttu-id="99721-109">Jeder Benutzer verfügt über SQL Server Systemadministrator `sysadmin` Berechtigungen () für die Instanz, die auf dem Computer ausgeführt wird, ohne dass Sie auch als Windows-Administrator ausgeführt werden müssen.</span><span class="sxs-lookup"><span data-stu-id="99721-109">Each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on their computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="99721-110">Software, die auf einer Benutzerinstanz mit eingeschränkten Berechtigungen ausgeführt wird, kann keine systemweiten Änderungen vornehmen, da die Instanz von SQL Server Express unter dem nicht zum Administrator gehörigen Windows-Konto des Benutzers und nicht als Dienst ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="99721-110">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="99721-111">Jede Benutzerinstanz ist von ihrer übergeordneten Instanz sowie von allen anderen Benutzerinstanzen, die auf demselben Computer ausgeführt werden, isoliert.</span><span class="sxs-lookup"><span data-stu-id="99721-111">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="99721-112">Datenbanken, die in einer Benutzerinstanz ausgeführt werden, werden nur im Einzelbenutzermodus geöffnet. Es ist nicht möglich, dass mehrere Benutzer eine Verbindung mit Datenbanken herstellen, die in einer Benutzerinstanz ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="99721-112">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="99721-113">Replikation und verteilte Abfragen sind für Benutzerinstanzen ebenfalls deaktiviert.</span><span class="sxs-lookup"><span data-stu-id="99721-113">Replication and distributed queries are also disabled for user instances.</span></span>
  
> [!NOTE]
> <span data-ttu-id="99721-114">Für Benutzer, die bereits Administratoren auf ihren eigenen Computern sind, oder für Szenarien mit mehreren Datenbankbenutzern werden keine Benutzerinstanzen benötigt.</span><span class="sxs-lookup"><span data-stu-id="99721-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="99721-115">Aktivieren von Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="99721-115">Enabling User Instances</span></span>  

 <span data-ttu-id="99721-116">Um Benutzerinstanzen zu generieren, muss eine übergeordnete Instanz von SQL Server Express ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="99721-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="99721-117">Benutzerinstanzen werden bei der Installation von SQL Server Express standardmäßig aktiviert. Sie können aber auch von einem Systemadministrator durch Ausführen der gespeicherten Systemprozedur **sp_configure** auf der übergeordneten Instanz explizit aktiviert oder deaktiviert werden.</span><span class="sxs-lookup"><span data-stu-id="99721-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```sql  
-- Enable user instances.  
sp_configure 'user instances enabled','1'
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="99721-118">Das Netzwerkprotokoll für Benutzerinstanzen muss Named Pipes (lokal) sein.</span><span class="sxs-lookup"><span data-stu-id="99721-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="99721-119">Eine Benutzerinstanz kann nicht in einer Remote-Instanz von SQL Server gestartet werden, und SQL Server-Anmeldungen sind nicht zulässig.</span><span class="sxs-lookup"><span data-stu-id="99721-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="99721-120">Herstellen einer Verbindung mit einer Benutzerinstanz</span><span class="sxs-lookup"><span data-stu-id="99721-120">Connecting to a User Instance</span></span>  

 <span data-ttu-id="99721-121">Mit den Schlüsselwörtern `User Instance` und `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> kann eine <xref:System.Data.SqlClient.SqlConnection> eine Verbindung mit einer Benutzerinstanz herstellen.</span><span class="sxs-lookup"><span data-stu-id="99721-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="99721-122">Benutzerinstanzen werden auch von den Eigenschaften <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` und `AttachDBFilename` unterstützt.</span><span class="sxs-lookup"><span data-stu-id="99721-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="99721-123">Beachten Sie Folgendes zum nachstehend gezeigten Beispiel einer Verbindungszeichenfolge:</span><span class="sxs-lookup"><span data-stu-id="99721-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="99721-124">Das Schlüsselwort `Data Source` bezieht sich auf die übergeordnete Instanz von SQL Server Express, die die Benutzerinstanz generiert.</span><span class="sxs-lookup"><span data-stu-id="99721-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="99721-125">Die Standardinstanz ist „.\sqlexpress“.</span><span class="sxs-lookup"><span data-stu-id="99721-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="99721-126">`Integrated Security` ist auf `true` festgelegt.</span><span class="sxs-lookup"><span data-stu-id="99721-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="99721-127">Um sich mit einer Benutzerinstanz zu verbinden, ist die Windows-Authentifizierung erforderlich. SQL Server-Anmeldungen werden nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="99721-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="99721-128">`User Instance` ist auf `true` festgelegt, wodurch eine Benutzerinstanz aufgerufen wird.</span><span class="sxs-lookup"><span data-stu-id="99721-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="99721-129">(Standardwert: `false`.)</span><span class="sxs-lookup"><span data-stu-id="99721-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="99721-130">Das Schlüsselwort `AttachDbFileName` für Verbindungszeichenfolgen wird zum Anfügen der primären Datenbankdatei (.mdf) verwendet, die den vollständigen Pfadnamen enthalten muss.</span><span class="sxs-lookup"><span data-stu-id="99721-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="99721-131">`AttachDbFileName` entspricht außerdem den Schlüsseln „extended properties“ und „initial file name“ in einer <xref:System.Data.SqlClient.SqlConnection>-Verbindungszeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="99721-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="99721-132">Die Ersetzungszeichenfolge `|DataDirectory|` zwischen senkrechten Strichen bezieht sich auf das Datenverzeichnis der Anwendung, die die Verbindung öffnet. Sie stellt einen relativen Pfad dar, der den Speicherort der MDF- und LDF-Datenbank und der Protokolldateien angibt.</span><span class="sxs-lookup"><span data-stu-id="99721-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="99721-133">Wenn Sie diese Dateien an einem anderen Speicherort ablegen möchten, müssen Sie den vollständigen Pfad zu den Dateien angeben.</span><span class="sxs-lookup"><span data-stu-id="99721-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="99721-134">Sie können auch die Eigenschaften <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> und <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> verwenden, um zur Laufzeit eine Verbindungszeichenfolge zu erstellen.</span><span class="sxs-lookup"><span data-stu-id="99721-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="99721-135">Verwenden der &#124;DataDirectory-&#124; Ersetzungs Zeichenfolge</span><span class="sxs-lookup"><span data-stu-id="99721-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  

 <span data-ttu-id="99721-136">`AttachDbFileName` wurde in ADO.NET 2.0 mit der Einführung der `|DataDirectory|`-Ersatzzeichenfolge (zwischen Pipesymbolen) erweitert.</span><span class="sxs-lookup"><span data-stu-id="99721-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="99721-137">`DataDirectory` wird in Verbindung mit `AttachDbFileName` verwendet, um einen relativen Pfad zu einer Datendatei anzugeben. Damit wird Entwicklern ermöglicht, Verbindungszeichenfolgen zu erstellen, die auf einem relativen Pfad zur Datenquelle basieren. Es muss kein vollständiger Pfad angegeben werden.</span><span class="sxs-lookup"><span data-stu-id="99721-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="99721-138">Der physische Speicherort, auf den `DataDirectory` zeigt, hängt von der Art der Anwendung ab.</span><span class="sxs-lookup"><span data-stu-id="99721-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="99721-139">In diesem Beispiel befindet sich die anzufügende Datei „Northwind.mdf“ im Ordner „\app_data“ der Anwendung.</span><span class="sxs-lookup"><span data-stu-id="99721-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="99721-140">Wenn `DataDirectory` verwendet wird, kann der resultierende Dateipfad in der Verzeichnisstruktur nicht höher sein als das Verzeichnis, auf das die Ersetzungszeichenfolge zeigt.</span><span class="sxs-lookup"><span data-stu-id="99721-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="99721-141">Wenn beispielsweise c:\AppDirectory\app_data das vollständig erweiterte `DataDirectory` ist, funktioniert die oben gezeigte Beispielverbindungszeichenfolge, weil sie sich unterhalb von c:\AppDirectory befindet.</span><span class="sxs-lookup"><span data-stu-id="99721-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="99721-142">Wenn aber versucht wird, `DataDirectory` als `|DataDirectory|\..\data` anzugeben, wird ein Fehler ausgelöst, weil „\data“ kein Unterverzeichnis von „\AppDirectory“ ist.</span><span class="sxs-lookup"><span data-stu-id="99721-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="99721-143">Wenn die Verbindungszeichenfolge eine falsch formatierte Ersetzungszeichenfolge hat, wird eine <xref:System.ArgumentException> ausgelöst.</span><span class="sxs-lookup"><span data-stu-id="99721-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="99721-144"><xref:System.Data.SqlClient> löst die Ersetzungszeichenfolgen in vollständige Pfade für das Dateisystem des lokalen Computers auf.</span><span class="sxs-lookup"><span data-stu-id="99721-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="99721-145">Daher werden Remoteserver-, HTTP- und UNC-Pfadnamen nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="99721-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="99721-146">Beim Öffnen der Verbindung wird eine Ausnahme ausgelöst, wenn sich der Server nicht auf dem lokalen Computer befindet.</span><span class="sxs-lookup"><span data-stu-id="99721-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="99721-147">Beim Öffnen von <xref:System.Data.SqlClient.SqlConnection> erfolgt eine Umleitung von der standardmäßigen SQL Server Express-Instanz zu einer zur Laufzeit gestarteten Instanz, die unter dem Konto des Aufrufers ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="99721-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="99721-148">Es kann nötig sein, den Wert <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> zu erhöhen, da das Laden von Benutzerinstanzen länger als bei normalen Instanzen dauern kann.</span><span class="sxs-lookup"><span data-stu-id="99721-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="99721-149">Das folgende Codefragment öffnet eine neue `SqlConnection`, zeigt die Verbindungszeichenfolge im Konsolenfenster an und schließt dann die Verbindung beim Verlassen des `using`-Codeblocks.</span><span class="sxs-lookup"><span data-stu-id="99721-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="99721-150">Benutzerinstanzen werden im CLR-Code (Common Language Runtime), der innerhalb von SQL Server ausgeführt wird, nicht unterstützt.</span><span class="sxs-lookup"><span data-stu-id="99721-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="99721-151">Eine <xref:System.InvalidOperationException> wird ausgelöst, wenn `Open` für eine <xref:System.Data.SqlClient.SqlConnection> aufgerufen wird, die `User Instance=true` in der Verbindungszeichenfolge enthält.</span><span class="sxs-lookup"><span data-stu-id="99721-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="99721-152">Lebensdauer einer Verbindung mit einer Benutzerinstanz</span><span class="sxs-lookup"><span data-stu-id="99721-152">Lifetime of a User Instance Connection</span></span>  

 <span data-ttu-id="99721-153">Im Gegensatz zu SQL Server-Versionen, die als Dienst ausgeführt werden, müssen SQL Server Express-Instanzen nicht manuell gestartet und beendet werden.</span><span class="sxs-lookup"><span data-stu-id="99721-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="99721-154">Jedes Mal, wenn sich ein Benutzer anmeldet und sich mit einer Benutzerinstanz verbindet, wird die Benutzerinstanz gestartet, falls sie nicht bereits ausgeführt wird.</span><span class="sxs-lookup"><span data-stu-id="99721-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="99721-155">Bei Datenbanken von Benutzerinstanzen ist die Option `AutoClose` so festgelegt, dass die Datenbank nach einem Zeitraum der Inaktivität automatisch heruntergefahren wird.</span><span class="sxs-lookup"><span data-stu-id="99721-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="99721-156">Der gestartete Prozess „sqlservr.exe“ wird nach dem Schließen der letzten Verbindung mit der Instanz mit einem Zeitlimit weiter ausgeführt, sodass er nicht neu gestartet werden muss, wenn vor Ablauf des Zeitlimits eine weitere Verbindung geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="99721-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="99721-157">Die Benutzerinstanz wird automatisch heruntergefahren, wenn vor Ablauf dieses Zeitlimits keine neue Verbindung geöffnet wird.</span><span class="sxs-lookup"><span data-stu-id="99721-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="99721-158">Ein Systemadministrator für die übergeordnete Instanz kann mit **sp_configure** die **user instance timeout**-Option (Timeout für Benutzerinstanz) ändern und so die Dauer des Timeoutzeitraums für die jeweilige Benutzerinstanz festlegen.</span><span class="sxs-lookup"><span data-stu-id="99721-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="99721-159">Der Standardwert ist 60 Sekunden.</span><span class="sxs-lookup"><span data-stu-id="99721-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="99721-160">Wenn `Min Pool Size` in der Verbindungszeichenfolge mit einem Wert größer als 0 verwendet wird, behält die Verbindungspoolfunktion stets einige wenige geöffnete Verbindungen bei, und die Benutzerinstanz wird nicht automatisch heruntergefahren.</span><span class="sxs-lookup"><span data-stu-id="99721-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="99721-161">So funktionieren Benutzerinstanzen</span><span class="sxs-lookup"><span data-stu-id="99721-161">How User Instances Work</span></span>  

 <span data-ttu-id="99721-162">Wenn eine Benutzerinstanz zum ersten Mal für einen Benutzer generiert wird, werden die Systemdatenbanken **master** und **msdb** zur exklusiven Verwendung durch die Benutzerinstanz aus dem Ordner „Template Data“ in einen Pfad im Verzeichnis des lokalen Anwendungsdatenrepository des Benutzers kopiert.</span><span class="sxs-lookup"><span data-stu-id="99721-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="99721-163">Dieser Pfad ist in der Regel `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="99721-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="99721-164">Beim Starten einer Benutzerinstanz werden außerdem die **tempdb**-, Protokoll- und Ablaufverfolgungsdateien in dieses Verzeichnis geschrieben.</span><span class="sxs-lookup"><span data-stu-id="99721-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="99721-165">Für die Instanz wird ein Name generiert, der für jeden Benutzer garantiert eindeutig ist.</span><span class="sxs-lookup"><span data-stu-id="99721-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="99721-166">Standardmäßig werden allen Mitgliedern der Windows-Gruppe „VORDEFINIERT\Benutzer“ Berechtigungen zum Herstellen einer Verbindung in der lokalen Instanz sowie Lese- und Ausführungsberechtigungen für die SQL Server-Binärdateien gewährt.</span><span class="sxs-lookup"><span data-stu-id="99721-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="99721-167">Sobald die Anmeldeinformationen des aufrufenden Benutzers, der die Benutzerinstanz hostet, überprüft wurden, wird dieser Benutzer zum `sysadmin` in dieser Instanz.</span><span class="sxs-lookup"><span data-stu-id="99721-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="99721-168">Für Benutzerinstanzen ist nur der gemeinsame genutzte Speicherbereich aktiviert, was bedeutet, dass nur Vorgänge auf dem lokalen Rechner möglich sind.</span><span class="sxs-lookup"><span data-stu-id="99721-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="99721-169">Benutzern müssen sowohl Lese- als auch Schreibberechtigungen für die in der Verbindungszeichenfolge angegebenen MDF- und LDF-Dateien erteilt werden.</span><span class="sxs-lookup"><span data-stu-id="99721-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="99721-170">Die MDF- und LDF-Dateien stellen die Datenbank- bzw. Protokolldateien dar.</span><span class="sxs-lookup"><span data-stu-id="99721-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="99721-171">Diese beiden Dateien sind ein zusammengehöriger Satz, weshalb bei Sicherungs- und Wiederherstellungsvorgängen Vorsicht geboten ist.</span><span class="sxs-lookup"><span data-stu-id="99721-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="99721-172">Die Datenbankdatei enthält Informationen über die genaue Version der Protokolldatei. Die Datenbank wird nicht geöffnet, wenn sie mit der falschen Protokolldatei gekoppelt ist.</span><span class="sxs-lookup"><span data-stu-id="99721-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="99721-173">Um Datenbeschädigungen zu vermeiden, wird eine Datenbank in der Benutzerinstanz mit exklusivem Zugriff geöffnet.</span><span class="sxs-lookup"><span data-stu-id="99721-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="99721-174">Wenn zwei verschiedene Benutzerinstanzen dieselbe Datenbank auf demselben Computer gemeinsam nutzen, muss der Benutzer der ersten Instanz die Datenbank schließen, bevor sie in einer zweiten Instanz geöffnet werden kann.</span><span class="sxs-lookup"><span data-stu-id="99721-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="99721-175">Benutzerinstanzszenarien</span><span class="sxs-lookup"><span data-stu-id="99721-175">User Instance Scenarios</span></span>  

 <span data-ttu-id="99721-176">Benutzerinstanzen bieten Entwicklern von Datenbankanwendungen einen SQL Server-Datenspeicher, der nicht davon abhängt, dass Entwickler über Administratorkonten auf ihren Entwicklungscomputern verfügen.</span><span class="sxs-lookup"><span data-stu-id="99721-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="99721-177">Benutzerinstanzen basieren auf dem Access-/Jet-Modell, bei dem die Datenbankanwendung einfach eine Verbindung mit einer Datei herstellt. Der Benutzer verfügt automatisch über die uneingeschränkten Berechtigungen für alle Datenbankobjekte, ohne dass ein Systemadministrator zum Erteilen von Berechtigungen eingreifen muss.</span><span class="sxs-lookup"><span data-stu-id="99721-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="99721-178">Es ist für Situationen gedacht, in denen der Benutzer ein Benutzerkonto mit den geringsten Rechten nutzt und keine administrativen Rechte auf dem Server oder dem lokalen Rechner hat, jedoch Datenbankobjekte und -anwendungen erstellen muss.</span><span class="sxs-lookup"><span data-stu-id="99721-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="99721-179">Benutzerinstanzen ermöglichen Benutzern, Instanzen zur Laufzeit zu erstellen, die im eigenen Sicherheitskontext und nicht im Sicherheitskontext eines Systemdiensts mit mehr Rechten ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="99721-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="99721-180">Benutzerinstanzen dürfen nur in Szenarien zum Einsatz kommen, in denen alle Anwendungen, die sie verwenden, vollständig vertrauenswürdig sind.</span><span class="sxs-lookup"><span data-stu-id="99721-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="99721-181">Szenarien für Benutzerinstanzen sind u. a.:</span><span class="sxs-lookup"><span data-stu-id="99721-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="99721-182">Einzelbenutzeranwendungen, bei denen das Freigeben von Daten nicht erforderlich ist.</span><span class="sxs-lookup"><span data-stu-id="99721-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="99721-183">ClickOnce-Bereitstellung.</span><span class="sxs-lookup"><span data-stu-id="99721-183">ClickOnce deployment.</span></span> <span data-ttu-id="99721-184">Wenn .NET Framework 2,0 (oder höher) und SQL Server Express bereits auf dem Zielcomputer installiert sind, kann das als Ergebnis einer ClickOnce-Aktion heruntergeladene Installationspaket installiert und von Benutzern ohne Administratorrechte verwendet werden.</span><span class="sxs-lookup"><span data-stu-id="99721-184">If .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="99721-185">Beachten Sie, dass ein Administrator SQL Server Express installieren muss, wenn dies Teil des Setups ist.</span><span class="sxs-lookup"><span data-stu-id="99721-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="99721-186">Weitere Informationen finden Sie unter [ClickOnce-Bereitstellung für Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span><span class="sxs-lookup"><span data-stu-id="99721-186">For more information, see [ClickOnce Deployment for Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span></span>
  
- <span data-ttu-id="99721-187">Dediziertes ASP.NET-Hosting mithilfe der Windows-Authentifizierung.</span><span class="sxs-lookup"><span data-stu-id="99721-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="99721-188">Eine einzelne SQL Server Express-Instanz kann in einem Intranet gehostet werden.</span><span class="sxs-lookup"><span data-stu-id="99721-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="99721-189">Die Anwendung stellt die Verbindung über das Windows-Konto ASPNET und nicht per Identitätswechsel her.</span><span class="sxs-lookup"><span data-stu-id="99721-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="99721-190">Benutzerinstanzen dürfen nicht in Szenarien mit Drittanbietern oder freigegebenem Hosting verwendet werden, bei denen alle Anwendungen dieselbe Benutzerinstanz gemeinsam nutzen und nicht mehr voneinander isoliert bleiben.</span><span class="sxs-lookup"><span data-stu-id="99721-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="99721-191">Weitere Informationen</span><span class="sxs-lookup"><span data-stu-id="99721-191">See also</span></span>

- [<span data-ttu-id="99721-192">SQL Server und ADO.NET</span><span class="sxs-lookup"><span data-stu-id="99721-192">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="99721-193">Verbindungs Zeichenfolgen</span><span class="sxs-lookup"><span data-stu-id="99721-193">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="99721-194">Herstellen der Verbindung mit einer Datenquelle</span><span class="sxs-lookup"><span data-stu-id="99721-194">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- [<span data-ttu-id="99721-195">Übersicht über ADO.NET</span><span class="sxs-lookup"><span data-stu-id="99721-195">ADO.NET Overview</span></span>](../ado-net-overview.md)
