---
title: Strukturen und Klassen
ms.date: 07/20/2015
helpviewer_keywords:
- classes [Visual Basic], vs. structures
- structures [Visual Basic]
- classes [Visual Basic]
- structures [Visual Basic], compared to classes
- structures [Visual Basic], structure variables
- structure variables [Visual Basic]
ms.assetid: a221e74a-ffcf-4bdc-a0f6-a088a9bf26cc
ms.openlocfilehash: e7ca5b9d55611eafad88517e71f9807fe2aa4416
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/23/2020
ms.locfileid: "91086217"
---
# <a name="structures-and-classes-visual-basic"></a><span data-ttu-id="8bb43-102">Strukturen und Klassen (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8bb43-102">Structures and Classes (Visual Basic)</span></span>

<span data-ttu-id="8bb43-103">Visual Basic vereinheitlicht die Syntax für Strukturen und Klassen, wobei beide Entitäten den größten Teil der gleichen Funktionen unterstützen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-103">Visual Basic unifies the syntax for structures and classes, with the result that both entities support most of the same features.</span></span> <span data-ttu-id="8bb43-104">Es gibt jedoch auch wichtige Unterschiede zwischen Strukturen und Klassen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-104">However, there are also important differences between structures and classes.</span></span>  
  
 <span data-ttu-id="8bb43-105">Klassen haben den Vorteil, dass Sie Verweis Typen sind – das Übergeben eines Verweises ist effizienter als das Übergeben einer Struktur Variablen mit sämtlichen Daten.</span><span class="sxs-lookup"><span data-stu-id="8bb43-105">Classes have the advantage of being reference types — passing a reference is more efficient than passing a structure variable with all its data.</span></span> <span data-ttu-id="8bb43-106">Andererseits erfordern Strukturen keine Speicher Belegung auf dem globalen Heap.</span><span class="sxs-lookup"><span data-stu-id="8bb43-106">On the other hand, structures do not require allocation of memory on the global heap.</span></span>  
  
 <span data-ttu-id="8bb43-107">Da Sie nicht von einer Struktur erben können, sollten Strukturen nur für Objekte verwendet werden, die nicht erweitert werden müssen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-107">Because you cannot inherit from a structure, structures should be used only for objects that do not need to be extended.</span></span> <span data-ttu-id="8bb43-108">Verwenden Sie Strukturen, wenn das Objekt, das Sie erstellen möchten, eine kleine instanzgröße hat, und berücksichtigen Sie die Leistungsmerkmale von Klassen im Vergleich zu Strukturen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-108">Use structures when the object you wish to create has a small instance size, and take into account the performance characteristics of classes versus structures.</span></span>  
  
## <a name="similarities"></a><span data-ttu-id="8bb43-109">Ähnlichkeiten</span><span class="sxs-lookup"><span data-stu-id="8bb43-109">Similarities</span></span>  

 <span data-ttu-id="8bb43-110">Strukturen und Klassen ähneln in den folgenden Punkten:</span><span class="sxs-lookup"><span data-stu-id="8bb43-110">Structures and classes are similar in the following respects:</span></span>  
  
- <span data-ttu-id="8bb43-111">Beide sind *Container* Typen. Dies bedeutet, dass Sie andere Typen als Member enthalten.</span><span class="sxs-lookup"><span data-stu-id="8bb43-111">Both are *container* types, meaning that they contain other types as members.</span></span>  
  
- <span data-ttu-id="8bb43-112">Beide verfügen über Member, die Konstruktoren, Methoden, Eigenschaften, Felder, Konstanten, Enumerationen, Ereignisse und Ereignishandler enthalten können.</span><span class="sxs-lookup"><span data-stu-id="8bb43-112">Both have members, which can include constructors, methods, properties, fields, constants, enumerations, events, and event handlers.</span></span> <span data-ttu-id="8bb43-113">Verwechseln Sie diese Member jedoch nicht mit den deklarierten *Elementen* einer Struktur.</span><span class="sxs-lookup"><span data-stu-id="8bb43-113">However, do not confuse these members with the declared *elements* of a structure.</span></span>  
  
- <span data-ttu-id="8bb43-114">Mitglieder beider Elemente können über individualisierte Zugriffsebenen verfügen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-114">Members of both can have individualized access levels.</span></span> <span data-ttu-id="8bb43-115">Beispielsweise kann ein Member deklariert `Public` und ein anderer Member deklariert werden `Private` .</span><span class="sxs-lookup"><span data-stu-id="8bb43-115">For example, one member can be declared `Public` and another `Private`.</span></span>  
  
- <span data-ttu-id="8bb43-116">Beide können Schnittstellen implementieren.</span><span class="sxs-lookup"><span data-stu-id="8bb43-116">Both can implement interfaces.</span></span>  
  
- <span data-ttu-id="8bb43-117">Beide können gemeinsame Konstruktoren mit oder ohne Parameter aufweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-117">Both can have shared constructors, with or without parameters.</span></span>  
  
- <span data-ttu-id="8bb43-118">Beide können eine *Default-Eigenschaft*verfügbar machen, sofern diese Eigenschaft mindestens einen Parameter annimmt.</span><span class="sxs-lookup"><span data-stu-id="8bb43-118">Both can expose a *default property*, provided that property takes at least one parameter.</span></span>  
  
- <span data-ttu-id="8bb43-119">Beide können Ereignisse deklarieren und auslassen, und beide können Delegaten deklarieren.</span><span class="sxs-lookup"><span data-stu-id="8bb43-119">Both can declare and raise events, and both can declare delegates.</span></span>  
  
## <a name="differences"></a><span data-ttu-id="8bb43-120">Unterschiede</span><span class="sxs-lookup"><span data-stu-id="8bb43-120">Differences</span></span>  

 <span data-ttu-id="8bb43-121">Strukturen und Klassen unterscheiden sich in den folgenden Details:</span><span class="sxs-lookup"><span data-stu-id="8bb43-121">Structures and classes differ in the following particulars:</span></span>  
  
- <span data-ttu-id="8bb43-122">Strukturen sind *Werttypen*. Klassen sind *Verweis Typen*.</span><span class="sxs-lookup"><span data-stu-id="8bb43-122">Structures are *value types*; classes are *reference types*.</span></span> <span data-ttu-id="8bb43-123">Eine Variable eines Struktur Typs enthält die Daten der Struktur, anstatt einen Verweis auf die Daten als Klassentyp zu enthalten.</span><span class="sxs-lookup"><span data-stu-id="8bb43-123">A variable of a structure type contains the structure's data, rather than containing a reference to the data as a class type does.</span></span>  
  
- <span data-ttu-id="8bb43-124">Strukturen verwenden die Stapel Zuordnung. Klassen verwenden Heap Zuordnung.</span><span class="sxs-lookup"><span data-stu-id="8bb43-124">Structures use stack allocation; classes use heap allocation.</span></span>  
  
- <span data-ttu-id="8bb43-125">Standardmäßig sind alle Strukturelemente `Public` , Klassen Variablen und Konstanten standardmäßig `Private` , während andere Klassenmember standardmäßig sind `Public` .</span><span class="sxs-lookup"><span data-stu-id="8bb43-125">All structure elements are `Public` by default; class variables and constants are `Private` by default, while other class members are `Public` by default.</span></span> <span data-ttu-id="8bb43-126">Dieses Verhalten für Klassenmember bietet Kompatibilität mit dem Visual Basic 6,0-System der Standardwerte.</span><span class="sxs-lookup"><span data-stu-id="8bb43-126">This behavior for class members provides compatibility with the Visual Basic 6.0 system of defaults.</span></span>  
  
- <span data-ttu-id="8bb43-127">Eine Struktur muss mindestens eine nicht freigegebene Variable oder ein nicht frei gegebenes, Nichtbenutzer definiertes Ereignis Element aufweisen. eine Klasse kann vollständig leer sein.</span><span class="sxs-lookup"><span data-stu-id="8bb43-127">A structure must have at least one nonshared variable or nonshared, noncustom event element; a class can be completely empty.</span></span>  
  
- <span data-ttu-id="8bb43-128">Strukturelemente können nicht als deklariert werden `Protected` , Klassenmember.</span><span class="sxs-lookup"><span data-stu-id="8bb43-128">Structure elements cannot be declared as `Protected`; class members can.</span></span>  
  
- <span data-ttu-id="8bb43-129">In einer Struktur Prozedur können Ereignisse nur behandelt werden, wenn es sich um eine frei [gegebene](../../../language-reference/modifiers/shared.md) `Sub` Prozedur handelt, und nur mithilfe der [AddHandler-Anweisung](../../../language-reference/statements/addhandler-statement.md). alle Klassen Prozeduren können Ereignisse behandeln, indem Sie entweder das [Handles](../../../language-reference/statements/handles-clause.md) -Schlüsselwort oder die- `AddHandler` Anweisung verwenden.</span><span class="sxs-lookup"><span data-stu-id="8bb43-129">A structure procedure can handle events only if it is a [Shared](../../../language-reference/modifiers/shared.md)`Sub` procedure, and only by means of the [AddHandler Statement](../../../language-reference/statements/addhandler-statement.md); any class procedure can handle events, using either the [Handles](../../../language-reference/statements/handles-clause.md) keyword or the `AddHandler` statement.</span></span> <span data-ttu-id="8bb43-130">Weitere Informationen finden Sie unter [Ereignisse](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="8bb43-130">For more information, see [Events](../events/index.md).</span></span>  
  
- <span data-ttu-id="8bb43-131">Struktur Variablen Deklarationen können keine Initialisierer oder anfangs Größen für Arrays angeben. Klassen Variablen Deklarationen können sein.</span><span class="sxs-lookup"><span data-stu-id="8bb43-131">Structure variable declarations cannot specify initializers or initial sizes for arrays; class variable declarations can.</span></span>  
  
- <span data-ttu-id="8bb43-132">Strukturen erben implizit von der <xref:System.ValueType?displayProperty=nameWithType> -Klasse und können nicht von einem anderen Typ erben; Klassen können von allen Klassen oder Klassen erben, die nicht sind <xref:System.ValueType?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="8bb43-132">Structures implicitly inherit from the <xref:System.ValueType?displayProperty=nameWithType> class and cannot inherit from any other type; classes can inherit from any class or classes other than <xref:System.ValueType?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="8bb43-133">Strukturen können nicht vererbt werden. Klassen sind.</span><span class="sxs-lookup"><span data-stu-id="8bb43-133">Structures are not inheritable; classes are.</span></span>  
  
- <span data-ttu-id="8bb43-134">Strukturen werden nie beendet, sodass die Common Language Runtime (CLR) niemals die <xref:System.Object.Finalize%2A> Methode für jede Struktur aufruft. Klassen werden von der Garbage Collector (GC) beendet, die <xref:System.Object.Finalize%2A> für eine Klasse aufruft, wenn Sie erkennt, dass keine aktiven Verweise vorhanden sind.</span><span class="sxs-lookup"><span data-stu-id="8bb43-134">Structures are never terminated, so the common language runtime (CLR) never calls the <xref:System.Object.Finalize%2A> method on any structure; classes are terminated by the garbage collector (GC), which calls <xref:System.Object.Finalize%2A> on a class when it detects there are no active references remaining.</span></span>  
  
- <span data-ttu-id="8bb43-135">Eine-Struktur erfordert keinen Konstruktor. eine-Klasse.</span><span class="sxs-lookup"><span data-stu-id="8bb43-135">A structure does not require a constructor; a class does.</span></span>  
  
- <span data-ttu-id="8bb43-136">Strukturen können nicht freigegebene Konstruktoren haben, wenn Sie Parameter annehmen. Klassen können Sie mit oder ohne Parameter aufweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-136">Structures can have nonshared constructors only if they take parameters; classes can have them with or without parameters.</span></span>  
  
 <span data-ttu-id="8bb43-137">Jede Struktur verfügt über einen impliziten öffentlichen Konstruktor ohne Parameter.</span><span class="sxs-lookup"><span data-stu-id="8bb43-137">Every structure has an implicit public constructor without parameters.</span></span> <span data-ttu-id="8bb43-138">Dieser Konstruktor initialisiert alle Datenelemente der-Struktur mit ihren Standardwerten.</span><span class="sxs-lookup"><span data-stu-id="8bb43-138">This constructor initializes all the structure's data elements to their default values.</span></span> <span data-ttu-id="8bb43-139">Dieses Verhalten kann nicht neu definiert werden.</span><span class="sxs-lookup"><span data-stu-id="8bb43-139">You cannot redefine this behavior.</span></span>  
  
## <a name="instances-and-variables"></a><span data-ttu-id="8bb43-140">Instanzen und Variablen</span><span class="sxs-lookup"><span data-stu-id="8bb43-140">Instances and Variables</span></span>  

 <span data-ttu-id="8bb43-141">Da Strukturen Werttypen sind, ist jede Struktur Variable permanent an eine einzelne Struktur Instanz gebunden.</span><span class="sxs-lookup"><span data-stu-id="8bb43-141">Because structures are value types, each structure variable is permanently bound to an individual structure instance.</span></span> <span data-ttu-id="8bb43-142">Klassen sind jedoch Verweis Typen, und eine Objekt Variable kann zu unterschiedlichen Zeitpunkten auf verschiedene Klassen Instanzen verweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-142">But classes are reference types, and an object variable can refer to various class instances at different times.</span></span> <span data-ttu-id="8bb43-143">Dieser Unterschied wirkt sich auf die Verwendung von Strukturen und Klassen auf folgende Weise aus:</span><span class="sxs-lookup"><span data-stu-id="8bb43-143">This distinction affects your usage of structures and classes in the following ways:</span></span>  
  
- <span data-ttu-id="8bb43-144">**Initialisierung.**</span><span class="sxs-lookup"><span data-stu-id="8bb43-144">**Initialization.**</span></span> <span data-ttu-id="8bb43-145">Eine Struktur Variable schließt implizit eine Initialisierung der Elemente mit dem Parameter losen Konstruktor der Struktur ein.</span><span class="sxs-lookup"><span data-stu-id="8bb43-145">A structure variable implicitly includes an initialization of the elements using the structure's parameterless constructor.</span></span> <span data-ttu-id="8bb43-146">Daher `Dim s As struct1` entspricht `Dim s As struct1 = New struct1()` .</span><span class="sxs-lookup"><span data-stu-id="8bb43-146">Therefore, `Dim s As struct1` is equivalent to `Dim s As struct1 = New struct1()`.</span></span>  
  
- <span data-ttu-id="8bb43-147">**Zuweisen von Variablen.**</span><span class="sxs-lookup"><span data-stu-id="8bb43-147">**Assigning Variables.**</span></span> <span data-ttu-id="8bb43-148">Wenn Sie eine Struktur Variable einem anderen zuweisen oder eine Struktur Instanz an ein Prozedur Argument übergeben, werden die aktuellen Werte aller Variablen Elemente in die neue Struktur kopiert.</span><span class="sxs-lookup"><span data-stu-id="8bb43-148">When you assign one structure variable to another, or pass a structure instance to a procedure argument, the current values of all the variable elements are copied to the new structure.</span></span> <span data-ttu-id="8bb43-149">Wenn Sie eine Objekt Variable einem anderen zuweisen oder eine Objekt Variable an eine Prozedur übergeben, wird nur der Verweis Zeiger kopiert.</span><span class="sxs-lookup"><span data-stu-id="8bb43-149">When you assign one object variable to another, or pass an object variable to a procedure, only the reference pointer is copied.</span></span>  
  
- <span data-ttu-id="8bb43-150">**Zuweisen von nichts.**</span><span class="sxs-lookup"><span data-stu-id="8bb43-150">**Assigning Nothing.**</span></span> <span data-ttu-id="8bb43-151">Sie können einem Struktur Variablen den Wert [Nothing](../../../language-reference/nothing.md) zuweisen, aber die Instanz wird weiterhin der Variablen zugeordnet.</span><span class="sxs-lookup"><span data-stu-id="8bb43-151">You can assign the value [Nothing](../../../language-reference/nothing.md) to a structure variable, but the instance continues to be associated with the variable.</span></span> <span data-ttu-id="8bb43-152">Sie können weiterhin seine Methoden aufrufen und auf dessen Datenelemente zugreifen, obwohl Variablen Elemente von der Zuweisung erneut initialisiert werden.</span><span class="sxs-lookup"><span data-stu-id="8bb43-152">You can still call its methods and access its data elements, although variable elements are reinitialized by the assignment.</span></span>  
  
     <span data-ttu-id="8bb43-153">Wenn Sie dagegen eine Objekt Variable auf festlegen, wird Sie `Nothing` von einer beliebigen Klasseninstanz getrennt, und Sie können erst dann auf Member über die Variable zugreifen, wenn Sie Ihr eine andere Instanz zuweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-153">In contrast, if you set an object variable to `Nothing`, you dissociate it from any class instance, and you cannot access any members through the variable until you assign another instance to it.</span></span>  
  
- <span data-ttu-id="8bb43-154">**Mehrere Instanzen.**</span><span class="sxs-lookup"><span data-stu-id="8bb43-154">**Multiple Instances.**</span></span> <span data-ttu-id="8bb43-155">Einer Objektvariablen können jeweils unterschiedliche Klassen Instanzen zugewiesen werden, und mehrere Objektvariablen können gleichzeitig auf dieselbe Klasseninstanz verweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-155">An object variable can have different class instances assigned to it at different times, and several object variables can refer to the same class instance at the same time.</span></span> <span data-ttu-id="8bb43-156">Änderungen, die Sie an den Werten von Klassenmembern vornehmen, wirken sich auf diese Member aus, wenn Sie über eine andere Variable auf dieselbe Instanz zugreifen</span><span class="sxs-lookup"><span data-stu-id="8bb43-156">Changes you make to the values of class members affect those members when accessed through another variable pointing to the same instance.</span></span>  
  
     <span data-ttu-id="8bb43-157">Strukturelemente sind jedoch innerhalb ihrer eigenen Instanz isoliert.</span><span class="sxs-lookup"><span data-stu-id="8bb43-157">Structure elements, however, are isolated within their own instance.</span></span> <span data-ttu-id="8bb43-158">Änderungen an ihren Werten werden in anderen Struktur Variablen nicht widergespiegelt, auch in anderen Instanzen der gleichen `Structure` Deklaration.</span><span class="sxs-lookup"><span data-stu-id="8bb43-158">Changes to their values are not reflected in any other structure variables, even in other instances of the same `Structure` declaration.</span></span>  
  
- <span data-ttu-id="8bb43-159">**Gleichheit.**</span><span class="sxs-lookup"><span data-stu-id="8bb43-159">**Equality.**</span></span> <span data-ttu-id="8bb43-160">Gleichheits Tests von zwei-Strukturen müssen mit einem Element-zu-Element-Test ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8bb43-160">Equality testing of two structures must be performed with an element-by-element test.</span></span> <span data-ttu-id="8bb43-161">Zwei Objektvariablen können mithilfe der-Methode verglichen werden <xref:System.Object.Equals%2A> .</span><span class="sxs-lookup"><span data-stu-id="8bb43-161">Two object variables can be compared using the <xref:System.Object.Equals%2A> method.</span></span> <span data-ttu-id="8bb43-162"><xref:System.Object.Equals%2A> Gibt an, ob die beiden Variablen auf dieselbe Instanz verweisen.</span><span class="sxs-lookup"><span data-stu-id="8bb43-162"><xref:System.Object.Equals%2A> indicates whether the two variables point to the same instance.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8bb43-163">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="8bb43-163">See also</span></span>

- [<span data-ttu-id="8bb43-164">Datentypen</span><span class="sxs-lookup"><span data-stu-id="8bb43-164">Data Types</span></span>](index.md)
- [<span data-ttu-id="8bb43-165">Zusammengesetzte Datentypen</span><span class="sxs-lookup"><span data-stu-id="8bb43-165">Composite Data Types</span></span>](composite-data-types.md)
- [<span data-ttu-id="8bb43-166">Wert- und Verweistypen</span><span class="sxs-lookup"><span data-stu-id="8bb43-166">Value Types and Reference Types</span></span>](value-types-and-reference-types.md)
- [<span data-ttu-id="8bb43-167">Strukturen</span><span class="sxs-lookup"><span data-stu-id="8bb43-167">Structures</span></span>](structures.md)
- [<span data-ttu-id="8bb43-168">Problembehandlung bei Datentypen</span><span class="sxs-lookup"><span data-stu-id="8bb43-168">Troubleshooting Data Types</span></span>](troubleshooting-data-types.md)
- [<span data-ttu-id="8bb43-169">Strukturen und andere Programmierelemente</span><span class="sxs-lookup"><span data-stu-id="8bb43-169">Structures and Other Programming Elements</span></span>](structures-and-other-programming-elements.md)
- [<span data-ttu-id="8bb43-170">Objekte und Klassen</span><span class="sxs-lookup"><span data-stu-id="8bb43-170">Objects and Classes</span></span>](../objects-and-classes/index.md)
