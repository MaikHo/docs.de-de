---
title: Anonyme Typen
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: 5ab3cf8c3c02ff35890f71ad6c7f314b51b87133
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: de-DE
ms.lasthandoff: 09/23/2020
ms.locfileid: "91075238"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="c52a2-102">Anonyme Typen (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c52a2-102">Anonymous Types (Visual Basic)</span></span>

<span data-ttu-id="c52a2-103">Visual Basic unterstützt anonyme Typen, die es Ihnen ermöglichen, Objekte zu erstellen, ohne eine Klassendefinition für den Datentyp zu schreiben.</span><span class="sxs-lookup"><span data-stu-id="c52a2-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="c52a2-104">Stattdessen erzeugt der Compiler eine Klasse.</span><span class="sxs-lookup"><span data-stu-id="c52a2-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="c52a2-105">Die Klasse hat keinen verwendbaren Namen, erbt direkt von <xref:System.Object> und enthält die Eigenschaften, die Sie beim Deklarieren des Objekts angeben.</span><span class="sxs-lookup"><span data-stu-id="c52a2-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="c52a2-106">Da der Name des Datentyps nicht angegeben wird, wird er als *anonymer Typ*bezeichnet.</span><span class="sxs-lookup"><span data-stu-id="c52a2-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="c52a2-107">Im folgenden Beispiel wird eine-Variable deklariert und `product` als Instanz eines anonymen Typs mit zwei Eigenschaften, und, erstellt `Name` `Price` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="c52a2-108">Ein *Abfrage Ausdruck* verwendet anonyme Typen, um von einer Abfrage ausgewählte Spalten von Daten zu kombinieren.</span><span class="sxs-lookup"><span data-stu-id="c52a2-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="c52a2-109">Sie können den Ergebnistyp nicht im Voraus definieren, da Sie die Spalten, die von einer bestimmten Abfrage ausgewählt werden können, nicht vorhersagen können.</span><span class="sxs-lookup"><span data-stu-id="c52a2-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="c52a2-110">Mit anonymen Typen können Sie eine Abfrage schreiben, die eine beliebige Anzahl von Spalten in beliebiger Reihenfolge auswählt.</span><span class="sxs-lookup"><span data-stu-id="c52a2-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="c52a2-111">Der Compiler erstellt einen Datentyp, der den angegebenen Eigenschaften und der angegebenen Reihenfolge entspricht.</span><span class="sxs-lookup"><span data-stu-id="c52a2-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="c52a2-112">In den folgenden Beispielen `products` ist eine Liste von Produkt Objekten, von denen jede über viele Eigenschaften verfügt.</span><span class="sxs-lookup"><span data-stu-id="c52a2-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="c52a2-113">`namePriceQuery`Die Variable enthält die Definition einer Abfrage, die bei der Ausführung eine Auflistung von Instanzen eines anonymen Typs mit zwei Eigenschaften, und, zurückgibt `Name` `Price` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="c52a2-114">`nameQuantityQuery`Die Variable enthält die Definition einer Abfrage, die bei der Ausführung eine Auflistung von Instanzen eines anonymen Typs mit zwei Eigenschaften, und, zurückgibt `Name` `OnHand` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="c52a2-115">Weitere Informationen zu dem Code, der vom Compiler für einen anonymen Typ erstellt wurde, finden Sie unter [Anonyme Typdefinition](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="c52a2-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="c52a2-116">Der Name des anonymen Typs ist vom Compiler generiert und kann von der Kompilierung bis zur Kompilierung abweichen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="c52a2-117">Der Code sollte nicht den Namen eines anonymen Typs verwenden oder darauf basieren, da sich der Name bei der erneuten Kompilierung eines Projekts ändern kann.</span><span class="sxs-lookup"><span data-stu-id="c52a2-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="c52a2-118">Deklarieren eines anonymen Typs</span><span class="sxs-lookup"><span data-stu-id="c52a2-118">Declaring an Anonymous Type</span></span>  

 <span data-ttu-id="c52a2-119">Die Deklaration einer Instanz eines anonymen Typs verwendet eine Initialisiererliste, um die Eigenschaften des Typs anzugeben.</span><span class="sxs-lookup"><span data-stu-id="c52a2-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="c52a2-120">Sie können nur Eigenschaften angeben, wenn Sie einen anonymen Typ deklarieren, nicht jedoch andere Klassen Elemente, wie z. b. Methoden oder Ereignisse.</span><span class="sxs-lookup"><span data-stu-id="c52a2-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="c52a2-121">Im folgenden Beispiel `product1` ist eine Instanz eines anonymen Typs mit zwei Eigenschaften: `Name` und `Price` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="c52a2-122">Wenn Sie Eigenschaften als Schlüsseleigenschaften festlegen, können Sie diese verwenden, um zwei anonyme Typinstanzen auf Gleichheit zu vergleichen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="c52a2-123">Die Werte der Schlüsseleigenschaften können jedoch nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="c52a2-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="c52a2-124">Weitere Informationen finden Sie im Abschnitt Schlüsseleigenschaften weiter unten in diesem Thema.</span><span class="sxs-lookup"><span data-stu-id="c52a2-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="c52a2-125">Beachten Sie, dass das Deklarieren einer Instanz eines anonymen Typs dem Deklarieren einer Instanz eines benannten Typs mithilfe eines Objektinitialisierers ähnelt:</span><span class="sxs-lookup"><span data-stu-id="c52a2-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="c52a2-126">Weitere Informationen zu anderen Methoden zum angeben anonymer Typeigenschaften finden Sie unter Gewusst [wie: Ableiten von Eigenschaften Namen und Typen in Deklarationen anonymer Typen](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="c52a2-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="c52a2-127">Schlüsseleigenschaften</span><span class="sxs-lookup"><span data-stu-id="c52a2-127">Key Properties</span></span>  

 <span data-ttu-id="c52a2-128">Schlüsseleigenschaften unterscheiden sich auf verschiedene Arten von nicht Schlüsseleigenschaften:</span><span class="sxs-lookup"><span data-stu-id="c52a2-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
- <span data-ttu-id="c52a2-129">Es werden nur die Werte der Schlüsseleigenschaften verglichen, um zu bestimmen, ob zwei Instanzen gleich sind.</span><span class="sxs-lookup"><span data-stu-id="c52a2-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
- <span data-ttu-id="c52a2-130">Die Werte der Schlüsseleigenschaften sind schreibgeschützt und können nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="c52a2-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
- <span data-ttu-id="c52a2-131">Nur Schlüssel Eigenschaftswerte sind im vom Compiler generierten Hash Code Algorithmus für einen anonymen Typ enthalten.</span><span class="sxs-lookup"><span data-stu-id="c52a2-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="c52a2-132">Gleichheit</span><span class="sxs-lookup"><span data-stu-id="c52a2-132">Equality</span></span>  

 <span data-ttu-id="c52a2-133">Instanzen anonymer Typen können nur gleich sein, wenn es sich um Instanzen desselben anonymen Typs handelt.</span><span class="sxs-lookup"><span data-stu-id="c52a2-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="c52a2-134">Der Compiler behandelt zwei Instanzen als Instanzen desselben Typs, wenn Sie die folgenden Bedingungen erfüllen:</span><span class="sxs-lookup"><span data-stu-id="c52a2-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
- <span data-ttu-id="c52a2-135">Sie werden in derselben Assembly deklariert.</span><span class="sxs-lookup"><span data-stu-id="c52a2-135">They are declared in the same assembly.</span></span>  
  
- <span data-ttu-id="c52a2-136">Ihre Eigenschaften haben die gleichen Namen, die gleichen abhergenten Typen und werden in derselben Reihenfolge deklariert.</span><span class="sxs-lookup"><span data-stu-id="c52a2-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="c52a2-137">Bei namens vergleichen wird die Groß-/Kleinschreibung nicht beachtet</span><span class="sxs-lookup"><span data-stu-id="c52a2-137">Name comparisons are not case-sensitive.</span></span>  
  
- <span data-ttu-id="c52a2-138">Die gleichen Eigenschaften sind jeweils als Schlüsseleigenschaften gekennzeichnet.</span><span class="sxs-lookup"><span data-stu-id="c52a2-138">The same properties in each are marked as key properties.</span></span>  
  
- <span data-ttu-id="c52a2-139">Mindestens eine Eigenschaft in jeder Deklaration ist eine Schlüsseleigenschaft.</span><span class="sxs-lookup"><span data-stu-id="c52a2-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="c52a2-140">Eine Instanz eines anonymen Typs ohne Schlüsseleigenschaften ist nur mit sich selbst identisch.</span><span class="sxs-lookup"><span data-stu-id="c52a2-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="c52a2-141">Zwei Instanzen desselben anonymen Typs sind gleich, wenn die Werte ihrer Schlüsseleigenschaften gleich sind.</span><span class="sxs-lookup"><span data-stu-id="c52a2-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="c52a2-142">In den folgenden Beispielen wird veranschaulicht, wie Gleichheit getestet wird.</span><span class="sxs-lookup"><span data-stu-id="c52a2-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="c52a2-143">Schreibgeschützte Werte</span><span class="sxs-lookup"><span data-stu-id="c52a2-143">Read-Only Values</span></span>  

 <span data-ttu-id="c52a2-144">Die Werte der Schlüsseleigenschaften können nicht geändert werden.</span><span class="sxs-lookup"><span data-stu-id="c52a2-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="c52a2-145">Beispielsweise sind in `prod8` im vorherigen Beispiel die `Name` `Price` Felder und `read-only` , aber Sie `OnHand` können geändert werden.</span><span class="sxs-lookup"><span data-stu-id="c52a2-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#8)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="c52a2-146">Anonyme Typen aus Abfrage Ausdrücken</span><span class="sxs-lookup"><span data-stu-id="c52a2-146">Anonymous Types from Query Expressions</span></span>  

 <span data-ttu-id="c52a2-147">Abfrage Ausdrücke erfordern nicht immer die Erstellung anonymer Typen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="c52a2-148">Wenn möglich, verwenden Sie einen vorhandenen Typ zum Speichern der Spaltendaten.</span><span class="sxs-lookup"><span data-stu-id="c52a2-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="c52a2-149">Dies tritt auf, wenn die Abfrage entweder ganze Datensätze aus der Datenquelle oder nur ein Feld aus jedem Datensatz zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="c52a2-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="c52a2-150">In den folgenden Codebeispielen `customers` ist eine Auflistung von-Objekten einer- `Customer` Klasse.</span><span class="sxs-lookup"><span data-stu-id="c52a2-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="c52a2-151">Die-Klasse verfügt über zahlreiche Eigenschaften, und Sie können eine oder mehrere davon in beliebiger Reihenfolge in das Abfrageergebnis einschließen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="c52a2-152">In den ersten beiden Beispielen sind keine anonymen Typen erforderlich, da die Abfragen Elemente benannter Typen auswählen:</span><span class="sxs-lookup"><span data-stu-id="c52a2-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
- <span data-ttu-id="c52a2-153">`custs1` enthält eine Auflistung von Zeichen folgen, da `cust.Name` eine Zeichenfolge ist.</span><span class="sxs-lookup"><span data-stu-id="c52a2-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
- <span data-ttu-id="c52a2-154">`custs2` enthält eine Auflistung von- `Customer` Objekten, da jedes Element von `customers` ein `Customer` -Objekt ist und das gesamte Element von der Abfrage ausgewählt wird.</span><span class="sxs-lookup"><span data-stu-id="c52a2-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="c52a2-155">Geeignete benannte Typen sind jedoch nicht immer verfügbar.</span><span class="sxs-lookup"><span data-stu-id="c52a2-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="c52a2-156">Möglicherweise möchten Sie Kundennamen und Adressen für einen Zweck, Kunden-ID-Nummern und Standorte für einen anderen, Kundennamen, Adressen und Bestell Verläufe für eine dritte auswählen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="c52a2-157">Mit anonymen Typen können Sie eine beliebige Kombination von Eigenschaften in beliebiger Reihenfolge auswählen, ohne zuerst einen neuen benannten Typ für das Ergebnis zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="c52a2-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="c52a2-158">Stattdessen erstellt der Compiler einen anonymen Typ für jede Kompilierung von Eigenschaften.</span><span class="sxs-lookup"><span data-stu-id="c52a2-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="c52a2-159">Mit der folgenden Abfrage werden nur der Name und die ID-Nummer des Kunden aus den einzelnen `Customer` Objekten in ausgewählt `customers` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="c52a2-160">Daher erstellt der Compiler einen anonymen Typ, der nur die beiden Eigenschaften enthält.</span><span class="sxs-lookup"><span data-stu-id="c52a2-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="c52a2-161">Sowohl der Name als auch die Datentypen der Eigenschaften im anonymen Typ werden von den Argumenten zu `Select` , und entnommen `cust.Name` `cust.ID` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="c52a2-162">Die Eigenschaften in einem anonymen Typ, der von einer Abfrage erstellt wird, sind immer Schlüsseleigenschaften.</span><span class="sxs-lookup"><span data-stu-id="c52a2-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="c52a2-163">Wenn `custs3` in der folgenden Schleife ausgeführt wird `For Each` , ist das Ergebnis eine Auflistung von Instanzen eines anonymen Typs mit zwei Schlüsseleigenschaften, `Name` und `ID` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="c52a2-164">Die Elemente in der durch dargestellten Auflistung `custs3` sind stark typisiert, und Sie können IntelliSense verwenden, um durch die verfügbaren Eigenschaften zu navigieren und deren Typen zu überprüfen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="c52a2-165">Weitere Informationen finden Sie unter [Einführung in LINQ in Visual Basic](../linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="c52a2-165">For more information, see [Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="c52a2-166">Entscheiden, ob anonyme Typen verwendet werden sollen</span><span class="sxs-lookup"><span data-stu-id="c52a2-166">Deciding Whether to Use Anonymous Types</span></span>  

 <span data-ttu-id="c52a2-167">Bevor Sie ein Objekt als Instanz einer anonymen Klasse erstellen, sollten Sie berücksichtigen, ob dies die beste Option ist.</span><span class="sxs-lookup"><span data-stu-id="c52a2-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="c52a2-168">Wenn Sie z. b. ein temporäres Objekt erstellen möchten, das verwandte Daten enthält, und Sie keine weiteren Felder und Methoden benötigen, die eine komplette Klasse enthalten kann, ist ein anonymer Typ eine gute Lösung.</span><span class="sxs-lookup"><span data-stu-id="c52a2-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="c52a2-169">Anonyme Typen sind auch dann praktisch, wenn Sie für jede Deklaration eine andere Auswahl von Eigenschaften benötigen oder wenn Sie die Reihenfolge der Eigenschaften ändern möchten.</span><span class="sxs-lookup"><span data-stu-id="c52a2-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="c52a2-170">Wenn das Projekt jedoch mehrere Objekte mit denselben Eigenschaften enthält, können Sie diese in einer festgelegten Reihenfolge leichter deklarieren, indem Sie einen benannten Typ mit einem Klassenkonstruktor verwenden.</span><span class="sxs-lookup"><span data-stu-id="c52a2-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="c52a2-171">Mit einem geeigneten Konstruktor ist es z. b. einfacher, mehrere Instanzen einer Klasse zu deklarieren, `Product` als mehrere Instanzen eines anonymen Typs zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="c52a2-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="c52a2-172">Ein weiterer Vorteil von benannten Typen besteht darin, dass der Compiler ein versehentliches falsch formatiping eines Eigenschafts namens abfangen kann.</span><span class="sxs-lookup"><span data-stu-id="c52a2-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="c52a2-173">In den vorherigen Beispielen sollen `firstProd2` , `secondProd2` und `thirdProd2` Instanzen desselben anonymen Typs sein.</span><span class="sxs-lookup"><span data-stu-id="c52a2-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="c52a2-174">Wenn Sie jedoch versehentlich `thirdProd2` auf eine der folgenden Arten deklarieren würden, unterscheidet sich der Typ von `firstProd2` und `secondProd2` .</span><span class="sxs-lookup"><span data-stu-id="c52a2-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="c52a2-175">Noch wichtiger ist, dass die Verwendung anonymer Typen, die nicht für Instanzen benannter Typen gelten, eingeschränkt ist.</span><span class="sxs-lookup"><span data-stu-id="c52a2-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="c52a2-176">`firstProd2`, `secondProd2` und `thirdProd2` sind Instanzen desselben anonymen Typs.</span><span class="sxs-lookup"><span data-stu-id="c52a2-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="c52a2-177">Der Name des freigegebenen anonymen Typs ist jedoch nicht verfügbar und kann nicht angezeigt werden, wenn in Ihrem Code ein Typname erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="c52a2-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="c52a2-178">Ein anonymer Typ kann z. b. nicht verwendet werden, um eine Methoden Signatur zu definieren, eine andere Variable oder ein anderes Feld oder eine Typdeklaration zu deklarieren.</span><span class="sxs-lookup"><span data-stu-id="c52a2-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="c52a2-179">Daher sind anonyme Typen nicht geeignet, wenn Sie Informationen über Methoden hinweg freigeben müssen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="c52a2-180">Eine anonyme Typdefinition</span><span class="sxs-lookup"><span data-stu-id="c52a2-180">An Anonymous Type Definition</span></span>  

 <span data-ttu-id="c52a2-181">Als Antwort auf die Deklaration einer Instanz eines anonymen Typs erstellt der Compiler eine neue Klassendefinition, die die angegebenen Eigenschaften enthält.</span><span class="sxs-lookup"><span data-stu-id="c52a2-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="c52a2-182">Wenn der anonyme Typ mindestens eine Schlüsseleigenschaft enthält, überschreibt die Definition drei von geerbte Member <xref:System.Object> : <xref:System.Object.Equals%2A> , <xref:System.Object.GetHashCode%2A> und <xref:System.Object.ToString%2A> .</span><span class="sxs-lookup"><span data-stu-id="c52a2-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="c52a2-183">Der Code, der zum Testen der Gleichheit und zum Ermitteln des Hashcodewerts erstellt wurde, berücksichtigt nur die Schlüsseleigenschaften.</span><span class="sxs-lookup"><span data-stu-id="c52a2-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="c52a2-184">Wenn der anonyme Typ keine Schlüsseleigenschaften enthält, <xref:System.Object.ToString%2A> wird nur überschrieben.</span><span class="sxs-lookup"><span data-stu-id="c52a2-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="c52a2-185">Explizit benannte Eigenschaften eines anonymen Typs können nicht mit diesen generierten Methoden in Konflikt stehen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="c52a2-186">Das heißt, Sie können, oder nicht verwenden, `.Equals` `.GetHashCode` `.ToString` um eine Eigenschaft zu benennen.</span><span class="sxs-lookup"><span data-stu-id="c52a2-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="c52a2-187">Anonyme Typdefinitionen, die über mindestens eine Schlüsseleigenschaft verfügen, implementieren auch die- <xref:System.IEquatable%601?displayProperty=nameWithType> Schnittstelle, wobei `T` der Typ des anonymen Typs ist.</span><span class="sxs-lookup"><span data-stu-id="c52a2-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="c52a2-188">Weitere Informationen zu dem vom Compiler erstellten Code und zu den Funktionen der überschriebenen Methoden finden Sie unter [Anonyme Typdefinition](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="c52a2-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c52a2-189">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="c52a2-189">See also</span></span>

- [<span data-ttu-id="c52a2-190">Objektinitialisierer: benannte und anonyme Typen</span><span class="sxs-lookup"><span data-stu-id="c52a2-190">Object Initializers: Named and Anonymous Types</span></span>](object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="c52a2-191">Lokaler Typrückschluss</span><span class="sxs-lookup"><span data-stu-id="c52a2-191">Local Type Inference</span></span>](../variables/local-type-inference.md)
- [<span data-ttu-id="c52a2-192">Einführung in LINQ in Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c52a2-192">Introduction to LINQ in Visual Basic</span></span>](../linq/introduction-to-linq.md)
- [<span data-ttu-id="c52a2-193">Vorgehensweise: Ableiten von Eigenschaftennamen und Typen in Deklarationen von anonymen Typen</span><span class="sxs-lookup"><span data-stu-id="c52a2-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="c52a2-194">Definition von anonymen Typen</span><span class="sxs-lookup"><span data-stu-id="c52a2-194">Anonymous Type Definition</span></span>](anonymous-type-definition.md)
- [<span data-ttu-id="c52a2-195">Schlüssel</span><span class="sxs-lookup"><span data-stu-id="c52a2-195">Key</span></span>](../../../language-reference/modifiers/key.md)
