---
title: Aktivieren einer Datenquelle für LINQ-Abfragen
description: In diesem Artikel erfahren Sie, wie Sie LINQ für eine Abfrage im LINQ-Muster in C# erweitern, mit dem Clients die Abfrage von Datenquellen erleichtert wird.
ms.date: 07/20/2015
ms.assetid: d2ef04a5-31a6-45cb-af9a-a5ce7732662c
ms.openlocfilehash: a3a03aa3c67ef80507de4607e21eee4d247d622d
ms.sourcegitcommit: 04022ca5d00b2074e1b1ffdbd76bec4950697c4c
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 07/23/2020
ms.locfileid: "87103935"
---
# <a name="enabling-a-data-source-for-linq-querying"></a><span data-ttu-id="f91e5-103">Aktivieren einer Datenquelle für LINQ-Abfragen</span><span class="sxs-lookup"><span data-stu-id="f91e5-103">Enabling a Data Source for LINQ Querying</span></span>
<span data-ttu-id="f91e5-104">Es gibt verschiedene Möglichkeiten, LINQ zu erweitern, um die Abfrage einer beliebigen Datenquelle im LINQ-Muster zu ermöglichen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-104">There are various ways to extend LINQ to enable any data source to be queried in the LINQ pattern.</span></span> <span data-ttu-id="f91e5-105">Bei der Datenquelle kann es sich u. a. um eine Datenstruktur, einen Webdienst, ein Dateisystem oder eine Datenbank handeln.</span><span class="sxs-lookup"><span data-stu-id="f91e5-105">The data source might be a data structure, a Web service, a file system, or a database, to name some.</span></span> <span data-ttu-id="f91e5-106">Das LINQ-Muster erleichtert Clients das Ausführen von Abfragen für eine Datenquelle mit aktivierter LINQ-Abfrage, da die Syntax und das Muster der Abfrage unverändert bleiben.</span><span class="sxs-lookup"><span data-stu-id="f91e5-106">The LINQ pattern makes it easy for clients to query a data source for which LINQ querying is enabled, because the syntax and pattern of the query does not change.</span></span> <span data-ttu-id="f91e5-107">LINQ kann u.a. auf folgende Weisen für die Verwendung dieser Datenquellen erweitert werden:</span><span class="sxs-lookup"><span data-stu-id="f91e5-107">The ways in which LINQ can be extended to these data sources include the following:</span></span>  
  
- <span data-ttu-id="f91e5-108">Implementieren der <xref:System.Collections.Generic.IEnumerable%601>-Schnittstelle in einem Typ, um LINQ to Objects-Abfragen für diesen Typ zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="f91e5-108">Implementing the <xref:System.Collections.Generic.IEnumerable%601> interface in a type to enable LINQ to Objects querying of that type.</span></span>  
  
- <span data-ttu-id="f91e5-109">Erstellen von Standardabfrageoperator-Methoden wie <xref:System.Linq.Enumerable.Where%2A> und <xref:System.Linq.Enumerable.Select%2A>, die einen Typ erweitern, um benutzerdefinierte LINQ-Abfragen für diesen Typ zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="f91e5-109">Creating standard query operator methods such as <xref:System.Linq.Enumerable.Where%2A> and <xref:System.Linq.Enumerable.Select%2A> that extend a type, to enable custom LINQ querying of that type.</span></span>  
  
- <span data-ttu-id="f91e5-110">Erstellen eines Anbieters für die Datenquelle, die die <xref:System.Linq.IQueryable%601>-Schnittstelle implementiert.</span><span class="sxs-lookup"><span data-stu-id="f91e5-110">Creating a provider for your data source that implements the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="f91e5-111">Ein Anbieter, der diese Schnittstelle implementiert, empfängt LINQ-Abfragen in Form von Ausdrucksbaumstrukturen, die er benutzerdefiniert ausführen kann, beispielsweise im Remotemodus.</span><span class="sxs-lookup"><span data-stu-id="f91e5-111">A provider that implements this interface receives LINQ queries in the form of expression trees, which it can execute in a custom way, for example remotely.</span></span>  
  
- <span data-ttu-id="f91e5-112">Erstellen eines Anbieters für die Datenquelle, die eine vorhandene LINQ-Technologie nutzt.</span><span class="sxs-lookup"><span data-stu-id="f91e5-112">Creating a provider for your data source that takes advantage of an existing LINQ technology.</span></span> <span data-ttu-id="f91e5-113">Durch einen solchen Anbieter werden nicht nur Abfragen ermöglicht, sondern zusätzlich Einfüge-, Aktualisierungs- und Löschvorgänge sowie Zuordnungen für benutzerdefinierte Typen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-113">Such a provider would enable not only querying, but also insert, update, and delete operations and mapping for user-defined types.</span></span>  
  
 <span data-ttu-id="f91e5-114">In diesem Thema werden diese Möglichkeiten erläutert.</span><span class="sxs-lookup"><span data-stu-id="f91e5-114">This topic discusses these options.</span></span>  
  
## <a name="how-to-enable-linq-querying-of-your-data-source"></a><span data-ttu-id="f91e5-115">Aktivieren von LINQ-Abfragen für eine Datenquelle</span><span class="sxs-lookup"><span data-stu-id="f91e5-115">How to Enable LINQ Querying of Your Data Source</span></span>  
  
### <a name="in-memory-data"></a><span data-ttu-id="f91e5-116">Daten im Arbeitsspeicher</span><span class="sxs-lookup"><span data-stu-id="f91e5-116">In-Memory Data</span></span>  
 <span data-ttu-id="f91e5-117">Es gibt zwei Möglichkeiten, LINQ-Abfragen von Daten im Arbeitsspeicher zu aktivieren.</span><span class="sxs-lookup"><span data-stu-id="f91e5-117">There are two ways you can enable LINQ querying of in-memory data.</span></span> <span data-ttu-id="f91e5-118">Wenn die Daten über einen Typ verfügen, der <xref:System.Collections.Generic.IEnumerable%601> implementiert, können Sie sie mithilfe von LINQ to Objects abfragen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-118">If the data is of a type that implements <xref:System.Collections.Generic.IEnumerable%601>, you can query the data by using LINQ to Objects.</span></span> <span data-ttu-id="f91e5-119">Wenn es nicht sinnvoll ist, die Enumeration des Typs durch Implementierung der <xref:System.Collections.Generic.IEnumerable%601>-Schnittstelle zu aktivieren, können Sie LINQ-Standardabfrageoperator-Methoden in diesem Typ definieren oder LINQ-Standardabfrageoperator-Methoden erstellen, die den Typ erweitern.</span><span class="sxs-lookup"><span data-stu-id="f91e5-119">If it does not make sense to enable enumeration of your type by implementing the <xref:System.Collections.Generic.IEnumerable%601> interface, you can define LINQ standard query operator methods in that type or create LINQ standard query operator methods that extend the type.</span></span> <span data-ttu-id="f91e5-120">Benutzerdefinierte Implementierungen der Standardabfrageoperatoren sollten zur Rückgabe der Ergebnisse eine verzögerte Ausführung verwenden.</span><span class="sxs-lookup"><span data-stu-id="f91e5-120">Custom implementations of the standard query operators should use deferred execution to return the results.</span></span>  
  
### <a name="remote-data"></a><span data-ttu-id="f91e5-121">Remotedaten</span><span class="sxs-lookup"><span data-stu-id="f91e5-121">Remote Data</span></span>  
 <span data-ttu-id="f91e5-122">Die beste Möglichkeit zur Aktivierung von LINQ-Abfragen für eine Remotedatenquelle besteht darin, die <xref:System.Linq.IQueryable%601>-Schnittstelle zu implementieren.</span><span class="sxs-lookup"><span data-stu-id="f91e5-122">The best option for enabling LINQ querying of a remote data source is to implement the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="f91e5-123">Dieser Ansatz unterscheidet sich jedoch vom Erweitern eines Anbieters wie [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] für eine Datenquelle.</span><span class="sxs-lookup"><span data-stu-id="f91e5-123">However, this differs from extending a provider such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] for a data source.</span></span> <span data-ttu-id="f91e5-124">Es stehen keine Anbietermodelle zum Erweitern vorhandener LINQ-Technologien (etwa [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)]) auf andere Datenquellentypen in Visual Studio 2008 zur Verfügung.</span><span class="sxs-lookup"><span data-stu-id="f91e5-124">No provider models for extending existing LINQ technologies, such as [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)], to other types of data source are available in Visual Studio 2008.</span></span>
  
## <a name="iqueryable-linq-providers"></a><span data-ttu-id="f91e5-125">LINQ-Anbieter "IQueryable"</span><span class="sxs-lookup"><span data-stu-id="f91e5-125">IQueryable LINQ Providers</span></span>  
 <span data-ttu-id="f91e5-126">LINQ-Anbieter, die <xref:System.Linq.IQueryable%601> implementieren, können in ihrer Komplexität große Unterschiede aufweisen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-126">LINQ providers that implement <xref:System.Linq.IQueryable%601> can vary widely in their complexity.</span></span> <span data-ttu-id="f91e5-127">In diesem Abschnitt werden die verschiedenen Komplexitätsstufen erläutert.</span><span class="sxs-lookup"><span data-stu-id="f91e5-127">This section discusses the different levels of complexity.</span></span>  
  
 <span data-ttu-id="f91e5-128">Ein weniger komplexer `IQueryable`-Anbieter erstellt möglicherweise eine Schnittstelle mit einer einzelnen Methode eines Webdiensts.</span><span class="sxs-lookup"><span data-stu-id="f91e5-128">A less complex `IQueryable` provider might interface with a single method of a Web service.</span></span> <span data-ttu-id="f91e5-129">Dieser Anbietertyp ist sehr spezifisch, da er erwartet, dass in den von ihm verarbeiteten Abfragen bestimmte Informationen enthalten sind.</span><span class="sxs-lookup"><span data-stu-id="f91e5-129">This type of provider is very specific because it expects specific information in the queries that it handles.</span></span> <span data-ttu-id="f91e5-130">Er verfügt über ein geschlossenes Typsystem und macht möglicherweise nur einen einzelnen Ergebnistyp verfügbar.</span><span class="sxs-lookup"><span data-stu-id="f91e5-130">It has a closed type system, perhaps exposing a single result type.</span></span> <span data-ttu-id="f91e5-131">Ein Großteil der Abfrageverarbeitung erfolgt lokal, beispielsweise unter Verwendung der <xref:System.Linq.Enumerable>-Implementierungen der Standardabfrageoperatoren.</span><span class="sxs-lookup"><span data-stu-id="f91e5-131">Most of the execution of the query occurs locally, for example by using the <xref:System.Linq.Enumerable> implementations of the standard query operators.</span></span> <span data-ttu-id="f91e5-132">Ein weniger komplexer Anbieter überprüft u. U. nur einen Ausdruck des Methodenaufrufs in der Ausdrucksbaumstruktur, die die Abfrage darstellt, und lässt die übrige Abfragelogik von einer anderen Instanz behandeln.</span><span class="sxs-lookup"><span data-stu-id="f91e5-132">A less complex provider might examine only one method call expression in the expression tree that represents the query, and let the remaining logic of the query be handled elsewhere.</span></span>  
  
 <span data-ttu-id="f91e5-133">Ein `IQueryable`-Anbieter mittlerer Komplexität verwendet möglicherweise eine Datenquelle als Ziel, die über eine teilweise ausdrucksbasierte Abfragesprache verfügt.</span><span class="sxs-lookup"><span data-stu-id="f91e5-133">An `IQueryable` provider of medium complexity might target a data source that has a partially expressive query language.</span></span> <span data-ttu-id="f91e5-134">Wenn ein Webdienst als Ziel verwendet wird, stellt der Anbieter vielleicht Verbindungen zu mehr als einer Webdienstmethode her und wählt die aufzurufende Methode auf der Grundlage der Frage aus, die von der Abfrage gestellt wird.</span><span class="sxs-lookup"><span data-stu-id="f91e5-134">If it targets a Web service, it might interface with more than one method of the Web service and select the method to call based on the question that the query poses.</span></span> <span data-ttu-id="f91e5-135">Ein Anbieter mittlerer Komplexität verfügt über ein umfangreicheres Typsystem als ein einfacher Anbieter, das jedoch weiterhin ein festes Typsystem darstellt.</span><span class="sxs-lookup"><span data-stu-id="f91e5-135">A provider of medium complexity would have a richer type system than a simple provider, but it would still be a fixed type system.</span></span> <span data-ttu-id="f91e5-136">Der Anbieter kann beispielsweise Typen verfügbar machen, die über 1:n-Beziehungen verfügen, die wiederum traversiert werden können, ohne eine Zuordnungstechnologie für benutzerdefinierte Typen bereitzustellen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-136">For example, the provider might expose types that have one-to-many relationships that can be traversed, but it would not provide mapping technology for user-defined types.</span></span>  
  
 <span data-ttu-id="f91e5-137">Ein komplexer `IQueryable`-Anbieter, wie z. B. der [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)]-Anbieter, kann möglicherweise vollständige LINQ-Abfragen in eine ausdrucksbasierte Abfragesprache wie SQL übersetzen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-137">A complex `IQueryable` provider, such as the [!INCLUDE[vbtecdlinq](~/includes/vbtecdlinq-md.md)] provider, might translate complete LINQ queries to an expressive query language, such as SQL.</span></span> <span data-ttu-id="f91e5-138">Ein komplexer Anbieter arbeitet universeller als ein weniger komplexer Anbieter, da er eine größere Bandbreite von Fragen in der Abfrage verarbeiten kann.</span><span class="sxs-lookup"><span data-stu-id="f91e5-138">A complex provider is more general than a less complex provider, because it can handle a wider variety of questions in the query.</span></span> <span data-ttu-id="f91e5-139">Außerdem verfügt er über ein offenes Typsystem und benötigt daher eine umfassende Infrastruktur für die Zuordnung benutzerdefinierter Typen.</span><span class="sxs-lookup"><span data-stu-id="f91e5-139">It also has an open type system and therefore must contain extensive infrastructure to map user-defined types.</span></span> <span data-ttu-id="f91e5-140">Die Entwicklung eines komplexen Anbieters ist ziemlich arbeitsaufwändig.</span><span class="sxs-lookup"><span data-stu-id="f91e5-140">Developing a complex provider requires a significant amount of effort.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f91e5-141">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="f91e5-141">See also</span></span>

- <xref:System.Linq.IQueryable%601>
- <xref:System.Collections.Generic.IEnumerable%601>
- <xref:System.Linq.Enumerable>
- [<span data-ttu-id="f91e5-142">Standard Query Operators Overview (C#) (Übersicht über Standardabfrageoperatoren (C#))</span><span class="sxs-lookup"><span data-stu-id="f91e5-142">Standard Query Operators Overview (C#)</span></span>](./standard-query-operators-overview.md)
- [<span data-ttu-id="f91e5-143">LINQ to Objects (C#)</span><span class="sxs-lookup"><span data-stu-id="f91e5-143">LINQ to Objects (C#)</span></span>](./linq-to-objects.md)
