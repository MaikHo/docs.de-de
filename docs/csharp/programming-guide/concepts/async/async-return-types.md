---
title: Asynchrone Rückgabetypen (C#)
description: Hier erhalten Sie Informationen zu Rückgabetypen, die asynchrone Methoden in C# aufweisen können, und Sie sehen Codebeispiele für die einzelnen Typen und weitere Ressourcen.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 71e560ed8ee0cae14da396e5ea2f3ab29611ebab
ms.sourcegitcommit: 9c45035b781caebc63ec8ecf912dc83fb6723b1f
ms.translationtype: HT
ms.contentlocale: de-DE
ms.lasthandoff: 08/25/2020
ms.locfileid: "88811495"
---
# <a name="async-return-types-c"></a><span data-ttu-id="8dfbd-103">Asynchrone Rückgabetypen (C#)</span><span class="sxs-lookup"><span data-stu-id="8dfbd-103">Async return types (C#)</span></span>

<span data-ttu-id="8dfbd-104">Asynchrone Methoden können folgende Rückgabetypen haben:</span><span class="sxs-lookup"><span data-stu-id="8dfbd-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="8dfbd-105"><xref:System.Threading.Tasks.Task> für eine asynchrone Methode, die einen Vorgang ausführt, aber keinen Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="8dfbd-106"><xref:System.Threading.Tasks.Task%601> für eine asynchrone Methode, die einen Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="8dfbd-107">`void` für einen Ereignishandler.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="8dfbd-108">Ab C# 7.0: jeder Typ, der über eine zugängliche `GetAwaiter`-Methode verfügt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="8dfbd-109">Das von der `GetAwaiter`-Methode zurückgegebene Objekt muss die <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType>-Schnittstelle implementieren.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="8dfbd-110">Ab C# 8.0 <xref:System.Collections.Generic.IAsyncEnumerable%601> für eine asynchrone Methode, die einen *asynchronen Datenstrom* zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="8dfbd-111">Weitere Informationen über async-Methoden finden Sie unter [Asynchrone Programmierung mit async und await (C#)](./index.md).</span><span class="sxs-lookup"><span data-stu-id="8dfbd-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="8dfbd-112">Es gibt auch einige weitere Typen, die spezifisch für Windows-Workloads gelten:</span><span class="sxs-lookup"><span data-stu-id="8dfbd-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="8dfbd-113"><xref:System.Windows.Threading.DispatcherOperation> für asynchrone Vorgänge, die auf Windows beschränkt sind</span><span class="sxs-lookup"><span data-stu-id="8dfbd-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="8dfbd-114"><xref:Windows.Foundation.IAsyncAction> für asynchrone Aktionen in UWP, die keinen Wert zurückgeben</span><span class="sxs-lookup"><span data-stu-id="8dfbd-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="8dfbd-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601> für asynchrone Aktionen in UWP, die den Fortschritt melden, aber keinen Wert zurückgeben</span><span class="sxs-lookup"><span data-stu-id="8dfbd-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="8dfbd-116"><xref:Windows.Foundation.IAsyncOperation%601> für asynchrone Vorgänge in UWP, die einen Wert zurückgeben</span><span class="sxs-lookup"><span data-stu-id="8dfbd-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="8dfbd-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602> für asynchrone Vorgänge in UWP, die den Fortschritt melden und einen Wert zurückgeben</span><span class="sxs-lookup"><span data-stu-id="8dfbd-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="8dfbd-118">Task-Rückgabetyp</span><span class="sxs-lookup"><span data-stu-id="8dfbd-118">Task return type</span></span>

<span data-ttu-id="8dfbd-119">Asynchrone Methoden, die keine `return`-Anweisung enthalten oder eine `return`-Anweisung enthalten, die keinen Operanden zurückgibt, haben normalerweise einen Rückgabetyp von <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="8dfbd-120">Solche Methoden geben `void` zurück, wenn sie synchron ausgeführt werden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="8dfbd-121">Wenn Sie einen <xref:System.Threading.Tasks.Task>-Rückgabetyp für eine asynchrone Methode verwenden, kann ein aufrufende Methode einen `await`-Operator verwenden, um den Abschluss des Aufrufers anzuhalten, bis die aufgerufene asynchrone Methode beendet ist.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="8dfbd-122">Im folgenden Beispiel enthält die `WaitAndApologizeAsync`-Methode keine `return`-Anweisung, weshalb die Methode ein <xref:System.Threading.Tasks.Task>-Objekt zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="8dfbd-123">Durch Rückgabe von `Task` wird ermöglicht, dass `WaitAndApologizeAsync` erwartet wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="8dfbd-124">Der Typ <xref:System.Threading.Tasks.Task> enthält keine `Result`-Eigenschaft, da er nicht über einen Rückgabewert verfügt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="8dfbd-125">`WaitAndApologizeAsync` wird erwartet, indem eine „await“-Anweisung anstelle eines „await“-Ausdrucks verwendet wird, ähnlich der Aufrufanweisung einer Methode, die „void“ zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="8dfbd-126">Die Anwendung eines Erwartungsoperators erzeugt in diesem Fall keinen Wert.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="8dfbd-127">Eine Erläuterung der Begriffe Anweisung und Ausdruck finden Sie in der folgenden Tabelle:</span><span class="sxs-lookup"><span data-stu-id="8dfbd-127">To clarify the terms statement and expression, refer to the table below:</span></span>

| <span data-ttu-id="8dfbd-128">Art von „await“</span><span class="sxs-lookup"><span data-stu-id="8dfbd-128">Await kind</span></span> | <span data-ttu-id="8dfbd-129">Beispiel</span><span class="sxs-lookup"><span data-stu-id="8dfbd-129">Example</span></span>                                      | <span data-ttu-id="8dfbd-130">type</span><span class="sxs-lookup"><span data-stu-id="8dfbd-130">Type</span></span>                                   |
|------------|----------------------------------------------|----------------------------------------|
| <span data-ttu-id="8dfbd-131">-Anweisung.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-131">Statement</span></span>  | `await SomeTaskMethodAsync()`                | <xref:System.Threading.Tasks.Task>     |
| <span data-ttu-id="8dfbd-132">Ausdruck</span><span class="sxs-lookup"><span data-stu-id="8dfbd-132">Expression</span></span> | `T result = await SomeTaskMethodAsync<T>();` | <xref:System.Threading.Tasks.Task%601> |

<span data-ttu-id="8dfbd-133">Sie können den `WaitAndApologizeAsync`-Aufruf eines await-Operators von der Anwendung trennen (dies wird im folgenden Code veranschaulicht).</span><span class="sxs-lookup"><span data-stu-id="8dfbd-133">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="8dfbd-134">Beachten Sie jedoch, dass `Task` über keine `Result`-Eigenschaft verfügt und dass kein Wert erzeugt wird, wenn ein Erwartungsoperator auf `Task` angewendet wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-134">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="8dfbd-135">Der folgende Code trennt Aufrufe der Methode `WaitAndApologizeAsync` vom Erwarten der Aufgabe, die die Methode zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-135">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="8dfbd-136">Task-Rückgabetyp \<TResult\></span><span class="sxs-lookup"><span data-stu-id="8dfbd-136">Task\<TResult\> return type</span></span>

<span data-ttu-id="8dfbd-137">Der Rückgabetyp <xref:System.Threading.Tasks.Task%601> wird für eine asynchrone Methode verwendet, die eine [return](../../../language-reference/keywords/return.md)-Anweisung enthält, in der der Operand `TResult` lautet.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-137">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="8dfbd-138">Im folgenden Beispiel enthält die `GetLeisureHoursAsync`-Methode eine `return`-Anweisung, die eine ganze Zahl zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-138">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="8dfbd-139">Aus diesem Grund muss die Methodendeklaration den Rückgabetyp `Task<int>` haben.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-139">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="8dfbd-140">Die asynchrone Methode <xref:System.Threading.Tasks.Task.FromResult%2A> ist ein Platzhalter für einen Vorgang, der einen <xref:System.DateTime.DayOfWeek>-Wert zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-140">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="8dfbd-141">Wenn `GetLeisureHoursAsync` aus einem „await“-Ausdruck in der Methode `ShowTodaysInfo` aufgerufen wird, ruft der „await“-Ausdruck den ganzzahligen Wert ab (der Wert von `GetLeisureHours`), der in der Aufgabe gespeichert wird, die von der Methode `leisureHours` zurückgegeben wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-141">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="8dfbd-142">Weitere Informationen zu await-Ausdrücken finden Sie unter [await](../../../language-reference/operators/await.md).</span><span class="sxs-lookup"><span data-stu-id="8dfbd-142">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="8dfbd-143">Wie `await` das Ergebnis aus einem `Task<T>` abruft, lässt sich besser erkennen, wenn Sie den Aufruf von `GetLeisureHoursAsync` von der Anwendung von `await` trennen, wie der folgende Code zeigt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-143">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="8dfbd-144">Ein Aufruf der `GetLeisureHoursAsync`-Methode, die nicht sofort eine Antwort erwartet, gibt ein `Task<int>` zurück, wie Sie es von der Deklaration der Methode erwarten.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-144">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="8dfbd-145">Die Aufgabe wird im Beispiel der `getLeisureHoursTask`-Variablen zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-145">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="8dfbd-146">Da `getLeisureHoursTask` eine <xref:System.Threading.Tasks.Task%601> ist, enthält es eine <xref:System.Threading.Tasks.Task%601.Result>-Eigenschaft des Typs `TResult`.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-146">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="8dfbd-147">In diesem Fall stellt `TResult` einen Integertyp dar.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-147">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="8dfbd-148">Wenn `await` auf `getLeisureHoursTask` angewendet wird, wertet der „await“-Ausdruck den Inhalt der Eigenschaft <xref:System.Threading.Tasks.Task%601.Result%2A> von `getLeisureHoursTask` aus.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-148">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="8dfbd-149">Der Wert wird der `ret`-Variablen zugewiesen.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-149">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="8dfbd-150">Die <xref:System.Threading.Tasks.Task%601.Result%2A>-Eigenschaft ist eine Blocking-Eigenschaft.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-150">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="8dfbd-151">Wenn Sie darauf zuzugreifen versuchen, bevor seine Aufgabe beendet ist, wird der momentan aktive Thread blockiert, bis die Aufgabe abgeschlossen und der Wert verfügbar ist.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-151">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="8dfbd-152">In den meisten Fällen sollten Sie auf den Wert zugreifen, indem Sie `await` verwenden, anstatt direkt auf die Eigenschaft zuzugreifen.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-152">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="8dfbd-153">Im vorherigen Beispiel wurde der Wert der <xref:System.Threading.Tasks.Task%601.Result%2A>-Eigenschaft abgerufen, um den Hauptthread zu blockieren, damit die `Main`-Methode `message` an die Konsole ausgeben konnte, bevor die Anwendung beendet wurde.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-153">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="8dfbd-154">Rückgabetyp „Void“</span><span class="sxs-lookup"><span data-stu-id="8dfbd-154">Void return type</span></span>

<span data-ttu-id="8dfbd-155">Der Rückgabetyp `void` wird in asynchronen Ereignishandlern verwendet, die den Rückgabetyp `void` erfordern.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-155">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="8dfbd-156">Für andere Methoden als Ereignishandler, die keinen Wert zurückgeben, sollten Sie stattdessen <xref:System.Threading.Tasks.Task> zurückgeben, da eine asynchrone Methode, die `void` zurückgibt, nicht erwartet werden kann.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-156">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="8dfbd-157">Jeder Aufrufer einer solchen Methode muss bis zum Abschluss ausgeführt werden, ohne darauf zu warten, dass die aufgerufene asynchrone Methode abgeschlossen wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-157">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="8dfbd-158">Der Aufrufer muss von allen Werten oder Ausnahmen unabhängig sein, die von der asynchronen Methode generiert werden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-158">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="8dfbd-159">Der Aufrufer einer asynchronen Methode, die „void“ zurückgibt, kann von der Methode ausgelöste Ausnahmen nicht behandeln, und solche Ausnahmefehler können möglicherweise zu Fehlern in der Anwendung führen.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-159">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="8dfbd-160">Wenn eine Methode, die <xref:System.Threading.Tasks.Task> oder <xref:System.Threading.Tasks.Task%601> zurückgibt, eine Ausnahme auslöst, wird die Ausnahme im zurückgegebenen Task gespeichert.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-160">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="8dfbd-161">Die Ausnahme wird erneut ausgelöst, wenn auf den Task gewartet wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-161">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="8dfbd-162">Stellen Sie daher sicher, dass jede asynchrone Methode, die eine Ausnahme erstellen kann, über den Rückgabetyp <xref:System.Threading.Tasks.Task> oder <xref:System.Threading.Tasks.Task%601> verfügt und die Aufrufe der Methode erwartet werden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-162">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="8dfbd-163">Weitere Informationen zum Auffangen von Ausnahmen in asynchronen Methoden finden Sie im Abschnitt [Ausnahmen in async-Methoden](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) des Artikels [try-catch (C#-Referenz)](../../../language-reference/keywords/try-catch.md).</span><span class="sxs-lookup"><span data-stu-id="8dfbd-163">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="8dfbd-164">Im folgenden Beispiel wird das Verhalten eines asynchronen Ereignishandlers dargestellt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-164">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="8dfbd-165">Im Beispielcode muss ein asynchroner Ereignishandler dem Hauptthread mitteilen, dass er abgeschlossen wurde.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-165">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="8dfbd-166">Anschließend kann der Hauptthread darauf warten, dass ein asynchroner Ereignishandler abgeschlossen wird, bevor das Programm beendet wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-166">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="8dfbd-167">Generalisierte asynchrone Rückgabetypen und ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="8dfbd-167">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="8dfbd-168">Ab C# 7.0 kann eine asynchrone Methode jeden Typ zurückgeben, der über eine zugängliche `GetAwaiter`-Methode verfügt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-168">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method.</span></span>

<span data-ttu-id="8dfbd-169">Da es sich bei <xref:System.Threading.Tasks.Task> und <xref:System.Threading.Tasks.Task%601> um Verweistypen handelt, kann bei der Speicherbelegung in leistungskritischen Pfaden, besonders bei Zuordnungen in engen Schleifen, die Leistung beeinträchtigt werden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-169">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="8dfbd-170">Die Unterstützung für generalisierte Rückgabetypen bedeutet, dass Sie einen einfachen Werttyp statt eines Verweistypen zurückgeben können, um zusätzliche Speicherbelegungen zu vermeiden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-170">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="8dfbd-171">.NET stellt die Struktur <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> als einfache Implementierung eines generalisierten Werts bereit, der eine Aufgabe zurückgibt.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-171">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="8dfbd-172">Sie müssen das NuGet-Paket `System.Threading.Tasks.Extensions` zu Ihrem Projekt hinzufügen, um den Typ <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> zu verwenden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-172">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="8dfbd-173">Im folgenden Beispiel wird die Struktur <xref:System.Threading.Tasks.ValueTask%601> verwendet, um den Wert von zwei Würfelvorgängen abzurufen.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-173">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="8dfbd-174">Asynchrone Datenströme mit IAsyncEnumerable\<T\></span><span class="sxs-lookup"><span data-stu-id="8dfbd-174">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="8dfbd-175">Ab C# 8.0 kann eine asynchrone Methode einen *asynchronen Datenstrom* zurückgeben, der durch <xref:System.Collections.Generic.IAsyncEnumerable%601> dargestellt wird.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-175">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="8dfbd-176">Ein asynchroner Datenstrom bietet eine Möglichkeit zur Aufzählung von Elementen, die aus einem Datenstrom gelesen wurden, wenn die Elemente mit wiederholten asynchronen Aufrufen in Blöcken generiert werden.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-176">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="8dfbd-177">Das folgende Beispiel zeigt eine asynchrone Methode, die einen asynchronen Datenstrom generiert:</span><span class="sxs-lookup"><span data-stu-id="8dfbd-177">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="8dfbd-178">Das oben gezeigte Beispiel liest asynchron Zeilen aus einer Zeichenfolge.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-178">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="8dfbd-179">Sobald eine Zeile gelesen wurde, zählt der Code jedes Wort in der Zeichenfolge auf.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-179">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="8dfbd-180">Aufrufen zählen die einzelnen Wörter mit der `await foreach`-Anweisung auf.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-180">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="8dfbd-181">Die Methode wartet, wenn sie die nächste Zeile aus der Quellzeichenfolge asynchron lesen muss.</span><span class="sxs-lookup"><span data-stu-id="8dfbd-181">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="8dfbd-182">Siehe auch</span><span class="sxs-lookup"><span data-stu-id="8dfbd-182">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="8dfbd-183">Verarbeiten asynchroner Aufgaben nach Abschluss</span><span class="sxs-lookup"><span data-stu-id="8dfbd-183">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="8dfbd-184">Asynchrone Programmierung mit Async und Await (C#)</span><span class="sxs-lookup"><span data-stu-id="8dfbd-184">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="8dfbd-185">async</span><span class="sxs-lookup"><span data-stu-id="8dfbd-185">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="8dfbd-186">await</span><span class="sxs-lookup"><span data-stu-id="8dfbd-186">await</span></span>](../../../language-reference/operators/await.md)
